<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.2"/>
    <title>exdpn.guards.logistic_regression_guard API documentation</title>
            <link rel="icon" href="https://aarkue.github.io/eXdpn/favicon.ico"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}@media (prefers-color-scheme:dark){pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}pre code .gp{user-select:none;}img{max-width:100%;display:block;margin-left:auto;margin-right:auto;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}@media (prefers-color-scheme:dark){:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}.dark-invert{filter:invert(1);}}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../guards.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;exdpn.guards</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

        <h2>Contents</h2>
        <ul>
  <li><a href="#guard">Guard</a></li>
</ul>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#Logistic_Regression_Guard">Logistic_Regression_Guard</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Logistic_Regression_Guard.__init__">Logistic_Regression_Guard</a>
                        </li>
                        <li>
                                <a class="function" href="#Logistic_Regression_Guard.train">train</a>
                        </li>
                        <li>
                                <a class="function" href="#Logistic_Regression_Guard.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#Logistic_Regression_Guard.is_explainable">is_explainable</a>
                        </li>
                        <li>
                                <a class="function" href="#Logistic_Regression_Guard.get_explainable_representation">get_explainable_representation</a>
                        </li>
                        <li>
                                <a class="function" href="#Logistic_Regression_Guard.get_global_explanations">get_global_explanations</a>
                        </li>
                        <li>
                                <a class="function" href="#Logistic_Regression_Guard.get_local_explanations">get_local_explanations</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>exdpn - version 1.1.1</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../exdpn.html">exdpn</a><wbr>.<a href="./../guards.html">guards</a><wbr>.logistic_regression_guard    </h1>

                        <div class="docstring"><p>This module contains the functionality to create different machine learning guards to model the behavior at decision points as well as an guard manager to automatically handle the guard training and selection for each decision point.</p>

<hr />

<h1 id="guard">Guard</h1>

<p>A guard is in this case a machine learning model which aims to model the behavior on a decision point. The goal is to receive a classification model which predicts the transition following a certain decision point using the data contained in the given event log. To get a better understanding on how the model works and provide a better understanding all machine learning techniques return an explainable representation of the fitted model. </p>

<hr />
</div>

                        <input id="logistic_regression_guard-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="logistic_regression_guard-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">.. include:: ./../../docs/_templates/md/guards/guard.md</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">import</span> <span class="nn">io</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">exdpn.data_preprocessing.data_preprocessing</span> <span class="kn">import</span> <span class="n">apply_ohe</span><span class="p">,</span> <span class="n">apply_scaling</span><span class="p">,</span> <span class="n">fit_scaling</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">exdpn.guards</span> <span class="kn">import</span> <span class="n">Guard</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">exdpn.data_preprocessing</span> <span class="kn">import</span> <span class="n">fit_ohe</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span> <span class="nn">pm4py.objects.petri_net.obj</span> <span class="kn">import</span> <span class="n">PetriNet</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">import</span> <span class="nn">shap</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">Logistic_Regression_Guard</span><span class="p">(</span><span class="n">Guard</span><span class="p">):</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.1375</span><span class="p">,</span> <span class="s1">&#39;tol&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">},</span> <span class="n">random_state</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>        <span class="sd">&quot;&quot;&quot;Initializes a logistic regression based guard with the provided hyperparameters.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">        Args:</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">            hyperparameters (Dict[str, Any]): Hyperparameters used for the classifier.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">            random_state (int, optional): The random state to be used for algorithms wherever possible. Defaults to None.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">        Raises:</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">            TypeError: If supplied hyperparameters are invalid.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        Examples:</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">            </span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">hyperparameters</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>        <span class="c1"># possible hyperparameter: C (regularization parameter)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="o">**</span><span class="n">hyperparameters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>                <span class="s2">&quot;Wrong hyperparameters were supplied to the logistic regression guard&quot;</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="sd">&quot;&quot;&quot;Trains the logistic regression guard using the dataset and the specified hyperparameters.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        Args:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">            X (DataFrame): Feature variables of the provided dataset, used to train the classifier behind the guard.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">            y (DataFrame): Target variable of the provided dataset, is to be predicted using `X`.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        Examples:</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">            &gt;&gt;&gt; # select a certrain decision point and the corresponding data set </span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>        <span class="c1"># scale numerical attributes</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span> <span class="o">=</span> <span class="n">fit_scaling</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span> <span class="o">=</span> <span class="n">fit_ohe</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="c1"># store feature names for the explainable representation</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="c1"># make transition to integer (i.e. ID) map</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>            <span class="n">transition</span><span class="p">:</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">transition</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)))}</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="n">y_transformed</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="p">[</span><span class="n">transition</span><span class="p">]</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>                         <span class="k">for</span> <span class="n">transition</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_transformed</span><span class="p">)</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_instances</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">PetriNet</span><span class="o">.</span><span class="n">Transition</span><span class="p">]:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="sd">&quot;&quot;&quot;Predicts the next transition based on the input instances.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        Args:</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">            input_instances (DataFrame): Dataset of input instances used to predict the target variable, i.e., the next transition.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        Returns:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">            List[PetriNet.Transition]: The list of predicted transitions.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        Examples:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">            </span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">            &gt;&gt;&gt; # select a certrain decision point and the corresponding data set </span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">            &gt;&gt;&gt; y_prediction = guard.predict(X_test)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="c1"># scale numerical attributes</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="n">input_instances</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>            <span class="n">input_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="n">input_instances</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">input_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="n">predicted_transition_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_instances</span><span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="c1"># ty stackoverflow</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="c1"># finds the key (transition) where the value (transition integer / id) corresponds to the predicted integer / id</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="c1"># for all predicted integers</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">trans</span> <span class="k">for</span> <span class="n">trans</span><span class="p">,</span> <span class="n">trans_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">trans_id</span> <span class="o">==</span> <span class="n">pred_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">pred_id</span> <span class="ow">in</span> <span class="n">predicted_transition_ids</span><span class="p">]</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">is_explainable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="sd">&quot;&quot;&quot;Returns whether or not this guard is explainable.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">        Returns:</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">            bool: Whether or not the guard is explainable.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">        Examples:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">            </span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">            &gt;&gt;&gt; guard.is_explainable()</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">            True</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">get_explainable_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="sd">&quot;&quot;&quot;Returns an explainable representation of the logistic regression guard, a Matplotlib plot using SHAP.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">        Args:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">            data (DataFrame): Dataset of input instances used to construct an explainable representation.</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">        Returns:</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">            Figure: Matplotlib Figure of the trained logistic regression model.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">        Raises:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">            Exception: If guard has no explainable representation.</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">        Examples:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">            &gt;&gt;&gt; # select a certain decision point and the corresponding data set </span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">            &gt;&gt;&gt; y_prediction = guard.predict(X_test)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">            &gt;&gt;&gt; # return figure of explainable representation</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">            &gt;&gt;&gt; fig = guard.get_explainable_representation(X_test) # results may deviate </span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">            </span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">            &lt;img src=&quot;../../images/lr-example-representation.svg&quot; alt=&quot;Example explainable representation of a logistic regression guard&quot; style=&quot;max-height: 350px;&quot;/&gt;</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">        Note: </span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">            For an example of the explainable representations of all machine learning techniques please check [Data Petri Net Example](https://github.com/aarkue/eXdpn/blob/main/docs/dpn_example.ipynb).</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_explainable</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>                <span class="s2">&quot;Guard is not explainable and therefore has no explainable representation&quot;</span><span class="p">)</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>                   <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">LinearExplainer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="c1"># Docs for this summary plot: https://shap-lrjball.readthedocs.io/en/latest/generated/shap.summary_plot.html</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                            <span class="n">data</span><span class="p">,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                            <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                            <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>                            <span class="n">class_names</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                            <span class="n">class_inds</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)))</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feature Impact on Model Prediction&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Feature Attributes&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">get_global_explanations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_sample</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Union</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="sd">&quot;&quot;&quot;Get a global explainable representation for the concrete machine learning classifier.</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">        Args:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">            base_sample (DataFrame): A small (10-30) sample of the population for this decision point; Used for calculation of shap values.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        Returns:</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">            Dict[str,Figure]: A dictionary containing the global explainable representations. Containing the following entries:</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">            - &quot;Bar plot (Summary)&quot;</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">            - &quot;Beeswarm plot for `X`&quot; (for all output labels X)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">            - &quot;Force plot for `X`&quot; (for all output labels X)</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>        <span class="n">unscaled_base_sample</span> <span class="o">=</span> <span class="n">processed_base_sample</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>            <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">unscaled_base_sample</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">():</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                    <span class="n">row</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_sample</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="k">def</span> <span class="nf">shap_predict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>            <span class="n">data_asframe</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">data_asframe</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">shap_predict</span><span class="p">,</span> <span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">l1_reg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;num_features(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="c1"># shap_values = explainer.shap_values(processed_base_sample)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                        <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span> <span class="n">unscaled_base_sample</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span> <span class="n">use_log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">max_display</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Bar plot (Summary)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="p">;</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_names</span><span class="p">)):</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">beeswarm</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">Explanation</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">shap_values</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>                                                            <span class="n">base_values</span><span class="o">=</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">unscaled_base_sample</span><span class="p">,</span>  
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>                                                    <span class="n">feature_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>                                                    <span class="n">order</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)))</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Beeswarm plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="n">force_plot</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">force_plot</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[[</span><span class="n">key</span><span class="p">]],</span><span class="n">shap_values</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">features</span><span class="o">=</span><span class="n">unscaled_base_sample</span><span class="p">,</span> <span class="n">out_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="n">html_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">save_html</span><span class="p">(</span><span class="n">html_data</span><span class="p">,</span><span class="n">force_plot</span><span class="p">,</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="n">html_data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># rewind the data</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Force plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">html_data</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">get_local_explanations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">local_data</span><span class="p">:</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">base_sample</span><span class="p">:</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Figure</span><span class="p">]:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="sd">&quot;&quot;&quot;Get explainable representations for a single decision situation. </span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        Args:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">            local_data (DataFrame): A dataframe containing the single decision situation.</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">            base_sample (DataFrame): A small (10-30) sample of the population for this decision point; Used for calculation of shap values.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        Returns:</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">            Dict[str,Figure]: A dictionary containing the explainable representations for the single decision situation. Containing the following entries:</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">            - &quot;Decision plot (Multioutput)&quot;</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">            - &quot;Decision plot for `X`&quot; (for all output labels X)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">            - &quot;Force plot for `X`&quot; (for all output labels X)</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">                </span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">        &quot;&quot;&quot;</span>  
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="k">assert</span> <span class="n">local_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="c1"># Pre-process local_data</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="c1"># Scale data</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="n">processed_local_data</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">local_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="c1"># One-Hot Encoding for categorical data</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="n">processed_local_data</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="c1"># Pre-process base_sample</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="c1"># Scale data</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="c1"># One-Hot Encoding for categorical data</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="c1"># transitions_labels =  {i: n for n,i in self.transition_int_map.items()}</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="c1"># target_names = [transitions_labels[i] for i in sorted(transitions_labels.keys())]</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>                   <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="k">def</span> <span class="nf">shap_predict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="n">data_asframe</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">data_asframe</span><span class="p">)</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">shap_predict</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>            <span class="n">shap_predict</span><span class="p">,</span> <span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="n">single_shap</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">l1_reg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;num_features(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="n">unscaled_local_data</span> <span class="o">=</span> <span class="n">processed_local_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">():</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>                <span class="n">unscaled_local_data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">local_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">multioutput_decision_plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">),</span><span class="n">single_shap</span><span class="p">,</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="n">features</span><span class="o">=</span><span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">row_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="n">highlight</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>        <span class="n">legend_location</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> <span class="n">feature_display_range</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Decision plot (Multioutput)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>        
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="n">winner_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">single_shap</span><span class="p">)):</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">decision_plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">)[</span><span class="n">key</span><span class="p">],</span><span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">features</span><span class="o">=</span><span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>            <span class="n">legend_labels</span><span class="o">=</span><span class="p">[</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]],</span> <span class="n">feature_display_range</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">highlight</span><span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">winner_index</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Decision plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">beeswarm</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">Explanation</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                                                            <span class="n">base_values</span><span class="o">=</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">processed_local_data</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                                                            <span class="n">order</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)))</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>            <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;WIP: Beeswarm plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="c1"># fig = plt.figure()</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">force_plot</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                            <span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>                            <span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">out_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">matplotlib</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                            <span class="c1"># link=&#39;logit&#39;,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>                            <span class="n">contribution_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Force plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="c1"># tests implemented examples</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>    <span class="kn">import</span> <span class="nn">doctest</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="c1"># run python .\exdpn\guards\logistic_regression_guard.py from eXdpn file</span>
</span></pre></div>


            </section>
                <section id="Logistic_Regression_Guard">
                            <input id="Logistic_Regression_Guard-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Logistic_Regression_Guard</span><wbr>(<span class="base"><a href="guard.html#Guard">exdpn.guards.guard.Guard</a></span>):

                <label class="view-source-button" for="Logistic_Regression_Guard-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Logistic_Regression_Guard"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Logistic_Regression_Guard-22"><a href="#Logistic_Regression_Guard-22"><span class="linenos"> 22</span></a><span class="k">class</span> <span class="nc">Logistic_Regression_Guard</span><span class="p">(</span><span class="n">Guard</span><span class="p">):</span>
</span><span id="Logistic_Regression_Guard-23"><a href="#Logistic_Regression_Guard-23"><span class="linenos"> 23</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.1375</span><span class="p">,</span> <span class="s1">&#39;tol&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">},</span> <span class="n">random_state</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-24"><a href="#Logistic_Regression_Guard-24"><span class="linenos"> 24</span></a>        <span class="sd">&quot;&quot;&quot;Initializes a logistic regression based guard with the provided hyperparameters.</span>
</span><span id="Logistic_Regression_Guard-25"><a href="#Logistic_Regression_Guard-25"><span class="linenos"> 25</span></a>
</span><span id="Logistic_Regression_Guard-26"><a href="#Logistic_Regression_Guard-26"><span class="linenos"> 26</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard-27"><a href="#Logistic_Regression_Guard-27"><span class="linenos"> 27</span></a><span class="sd">            hyperparameters (Dict[str, Any]): Hyperparameters used for the classifier.</span>
</span><span id="Logistic_Regression_Guard-28"><a href="#Logistic_Regression_Guard-28"><span class="linenos"> 28</span></a><span class="sd">            random_state (int, optional): The random state to be used for algorithms wherever possible. Defaults to None.</span>
</span><span id="Logistic_Regression_Guard-29"><a href="#Logistic_Regression_Guard-29"><span class="linenos"> 29</span></a>
</span><span id="Logistic_Regression_Guard-30"><a href="#Logistic_Regression_Guard-30"><span class="linenos"> 30</span></a><span class="sd">        Raises:</span>
</span><span id="Logistic_Regression_Guard-31"><a href="#Logistic_Regression_Guard-31"><span class="linenos"> 31</span></a><span class="sd">            TypeError: If supplied hyperparameters are invalid.</span>
</span><span id="Logistic_Regression_Guard-32"><a href="#Logistic_Regression_Guard-32"><span class="linenos"> 32</span></a>
</span><span id="Logistic_Regression_Guard-33"><a href="#Logistic_Regression_Guard-33"><span class="linenos"> 33</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard-34"><a href="#Logistic_Regression_Guard-34"><span class="linenos"> 34</span></a><span class="sd">            </span>
</span><span id="Logistic_Regression_Guard-35"><a href="#Logistic_Regression_Guard-35"><span class="linenos"> 35</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard-36"><a href="#Logistic_Regression_Guard-36"><span class="linenos"> 36</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard-37"><a href="#Logistic_Regression_Guard-37"><span class="linenos"> 37</span></a>
</span><span id="Logistic_Regression_Guard-38"><a href="#Logistic_Regression_Guard-38"><span class="linenos"> 38</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard-39"><a href="#Logistic_Regression_Guard-39"><span class="linenos"> 39</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard-40"><a href="#Logistic_Regression_Guard-40"><span class="linenos"> 40</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">hyperparameters</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-41"><a href="#Logistic_Regression_Guard-41"><span class="linenos"> 41</span></a>        <span class="c1"># possible hyperparameter: C (regularization parameter)</span>
</span><span id="Logistic_Regression_Guard-42"><a href="#Logistic_Regression_Guard-42"><span class="linenos"> 42</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-43"><a href="#Logistic_Regression_Guard-43"><span class="linenos"> 43</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="o">**</span><span class="n">hyperparameters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-44"><a href="#Logistic_Regression_Guard-44"><span class="linenos"> 44</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-45"><a href="#Logistic_Regression_Guard-45"><span class="linenos"> 45</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="Logistic_Regression_Guard-46"><a href="#Logistic_Regression_Guard-46"><span class="linenos"> 46</span></a>                <span class="s2">&quot;Wrong hyperparameters were supplied to the logistic regression guard&quot;</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-47"><a href="#Logistic_Regression_Guard-47"><span class="linenos"> 47</span></a>
</span><span id="Logistic_Regression_Guard-48"><a href="#Logistic_Regression_Guard-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard-49"><a href="#Logistic_Regression_Guard-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard-50"><a href="#Logistic_Regression_Guard-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard-51"><a href="#Logistic_Regression_Guard-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard-52"><a href="#Logistic_Regression_Guard-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard-53"><a href="#Logistic_Regression_Guard-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="Logistic_Regression_Guard-54"><a href="#Logistic_Regression_Guard-54"><span class="linenos"> 54</span></a>
</span><span id="Logistic_Regression_Guard-55"><a href="#Logistic_Regression_Guard-55"><span class="linenos"> 55</span></a>    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-56"><a href="#Logistic_Regression_Guard-56"><span class="linenos"> 56</span></a>        <span class="sd">&quot;&quot;&quot;Trains the logistic regression guard using the dataset and the specified hyperparameters.</span>
</span><span id="Logistic_Regression_Guard-57"><a href="#Logistic_Regression_Guard-57"><span class="linenos"> 57</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard-58"><a href="#Logistic_Regression_Guard-58"><span class="linenos"> 58</span></a><span class="sd">            X (DataFrame): Feature variables of the provided dataset, used to train the classifier behind the guard.</span>
</span><span id="Logistic_Regression_Guard-59"><a href="#Logistic_Regression_Guard-59"><span class="linenos"> 59</span></a><span class="sd">            y (DataFrame): Target variable of the provided dataset, is to be predicted using `X`.</span>
</span><span id="Logistic_Regression_Guard-60"><a href="#Logistic_Regression_Guard-60"><span class="linenos"> 60</span></a>
</span><span id="Logistic_Regression_Guard-61"><a href="#Logistic_Regression_Guard-61"><span class="linenos"> 61</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard-62"><a href="#Logistic_Regression_Guard-62"><span class="linenos"> 62</span></a>
</span><span id="Logistic_Regression_Guard-63"><a href="#Logistic_Regression_Guard-63"><span class="linenos"> 63</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="Logistic_Regression_Guard-64"><a href="#Logistic_Regression_Guard-64"><span class="linenos"> 64</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="Logistic_Regression_Guard-65"><a href="#Logistic_Regression_Guard-65"><span class="linenos"> 65</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="Logistic_Regression_Guard-66"><a href="#Logistic_Regression_Guard-66"><span class="linenos"> 66</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard-67"><a href="#Logistic_Regression_Guard-67"><span class="linenos"> 67</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="Logistic_Regression_Guard-68"><a href="#Logistic_Regression_Guard-68"><span class="linenos"> 68</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="Logistic_Regression_Guard-69"><a href="#Logistic_Regression_Guard-69"><span class="linenos"> 69</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="Logistic_Regression_Guard-70"><a href="#Logistic_Regression_Guard-70"><span class="linenos"> 70</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="Logistic_Regression_Guard-71"><a href="#Logistic_Regression_Guard-71"><span class="linenos"> 71</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="Logistic_Regression_Guard-72"><a href="#Logistic_Regression_Guard-72"><span class="linenos"> 72</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="Logistic_Regression_Guard-73"><a href="#Logistic_Regression_Guard-73"><span class="linenos"> 73</span></a><span class="sd">            &gt;&gt;&gt; # select a certrain decision point and the corresponding data set </span>
</span><span id="Logistic_Regression_Guard-74"><a href="#Logistic_Regression_Guard-74"><span class="linenos"> 74</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="Logistic_Regression_Guard-75"><a href="#Logistic_Regression_Guard-75"><span class="linenos"> 75</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="Logistic_Regression_Guard-76"><a href="#Logistic_Regression_Guard-76"><span class="linenos"> 76</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="Logistic_Regression_Guard-77"><a href="#Logistic_Regression_Guard-77"><span class="linenos"> 77</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard-78"><a href="#Logistic_Regression_Guard-78"><span class="linenos"> 78</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="Logistic_Regression_Guard-79"><a href="#Logistic_Regression_Guard-79"><span class="linenos"> 79</span></a>
</span><span id="Logistic_Regression_Guard-80"><a href="#Logistic_Regression_Guard-80"><span class="linenos"> 80</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard-81"><a href="#Logistic_Regression_Guard-81"><span class="linenos"> 81</span></a>
</span><span id="Logistic_Regression_Guard-82"><a href="#Logistic_Regression_Guard-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard-83"><a href="#Logistic_Regression_Guard-83"><span class="linenos"> 83</span></a>        <span class="c1"># scale numerical attributes</span>
</span><span id="Logistic_Regression_Guard-84"><a href="#Logistic_Regression_Guard-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span> <span class="o">=</span> <span class="n">fit_scaling</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-85"><a href="#Logistic_Regression_Guard-85"><span class="linenos"> 85</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-86"><a href="#Logistic_Regression_Guard-86"><span class="linenos"> 86</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard-87"><a href="#Logistic_Regression_Guard-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span> <span class="o">=</span> <span class="n">fit_ohe</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-88"><a href="#Logistic_Regression_Guard-88"><span class="linenos"> 88</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-89"><a href="#Logistic_Regression_Guard-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="Logistic_Regression_Guard-90"><a href="#Logistic_Regression_Guard-90"><span class="linenos"> 90</span></a>
</span><span id="Logistic_Regression_Guard-91"><a href="#Logistic_Regression_Guard-91"><span class="linenos"> 91</span></a>        <span class="c1"># store feature names for the explainable representation</span>
</span><span id="Logistic_Regression_Guard-92"><a href="#Logistic_Regression_Guard-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-93"><a href="#Logistic_Regression_Guard-93"><span class="linenos"> 93</span></a>
</span><span id="Logistic_Regression_Guard-94"><a href="#Logistic_Regression_Guard-94"><span class="linenos"> 94</span></a>        <span class="c1"># make transition to integer (i.e. ID) map</span>
</span><span id="Logistic_Regression_Guard-95"><a href="#Logistic_Regression_Guard-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Logistic_Regression_Guard-96"><a href="#Logistic_Regression_Guard-96"><span class="linenos"> 96</span></a>            <span class="n">transition</span><span class="p">:</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">transition</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)))}</span>
</span><span id="Logistic_Regression_Guard-97"><a href="#Logistic_Regression_Guard-97"><span class="linenos"> 97</span></a>        <span class="n">y_transformed</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="p">[</span><span class="n">transition</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard-98"><a href="#Logistic_Regression_Guard-98"><span class="linenos"> 98</span></a>                         <span class="k">for</span> <span class="n">transition</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard-99"><a href="#Logistic_Regression_Guard-99"><span class="linenos"> 99</span></a>
</span><span id="Logistic_Regression_Guard-100"><a href="#Logistic_Regression_Guard-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_transformed</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-101"><a href="#Logistic_Regression_Guard-101"><span class="linenos">101</span></a>
</span><span id="Logistic_Regression_Guard-102"><a href="#Logistic_Regression_Guard-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_instances</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">PetriNet</span><span class="o">.</span><span class="n">Transition</span><span class="p">]:</span>
</span><span id="Logistic_Regression_Guard-103"><a href="#Logistic_Regression_Guard-103"><span class="linenos">103</span></a>        <span class="sd">&quot;&quot;&quot;Predicts the next transition based on the input instances.</span>
</span><span id="Logistic_Regression_Guard-104"><a href="#Logistic_Regression_Guard-104"><span class="linenos">104</span></a>
</span><span id="Logistic_Regression_Guard-105"><a href="#Logistic_Regression_Guard-105"><span class="linenos">105</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard-106"><a href="#Logistic_Regression_Guard-106"><span class="linenos">106</span></a><span class="sd">            input_instances (DataFrame): Dataset of input instances used to predict the target variable, i.e., the next transition.</span>
</span><span id="Logistic_Regression_Guard-107"><a href="#Logistic_Regression_Guard-107"><span class="linenos">107</span></a>
</span><span id="Logistic_Regression_Guard-108"><a href="#Logistic_Regression_Guard-108"><span class="linenos">108</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard-109"><a href="#Logistic_Regression_Guard-109"><span class="linenos">109</span></a><span class="sd">            List[PetriNet.Transition]: The list of predicted transitions.</span>
</span><span id="Logistic_Regression_Guard-110"><a href="#Logistic_Regression_Guard-110"><span class="linenos">110</span></a>
</span><span id="Logistic_Regression_Guard-111"><a href="#Logistic_Regression_Guard-111"><span class="linenos">111</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard-112"><a href="#Logistic_Regression_Guard-112"><span class="linenos">112</span></a><span class="sd">            </span>
</span><span id="Logistic_Regression_Guard-113"><a href="#Logistic_Regression_Guard-113"><span class="linenos">113</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="Logistic_Regression_Guard-114"><a href="#Logistic_Regression_Guard-114"><span class="linenos">114</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="Logistic_Regression_Guard-115"><a href="#Logistic_Regression_Guard-115"><span class="linenos">115</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="Logistic_Regression_Guard-116"><a href="#Logistic_Regression_Guard-116"><span class="linenos">116</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard-117"><a href="#Logistic_Regression_Guard-117"><span class="linenos">117</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="Logistic_Regression_Guard-118"><a href="#Logistic_Regression_Guard-118"><span class="linenos">118</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="Logistic_Regression_Guard-119"><a href="#Logistic_Regression_Guard-119"><span class="linenos">119</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="Logistic_Regression_Guard-120"><a href="#Logistic_Regression_Guard-120"><span class="linenos">120</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="Logistic_Regression_Guard-121"><a href="#Logistic_Regression_Guard-121"><span class="linenos">121</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="Logistic_Regression_Guard-122"><a href="#Logistic_Regression_Guard-122"><span class="linenos">122</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="Logistic_Regression_Guard-123"><a href="#Logistic_Regression_Guard-123"><span class="linenos">123</span></a><span class="sd">            &gt;&gt;&gt; # select a certrain decision point and the corresponding data set </span>
</span><span id="Logistic_Regression_Guard-124"><a href="#Logistic_Regression_Guard-124"><span class="linenos">124</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="Logistic_Regression_Guard-125"><a href="#Logistic_Regression_Guard-125"><span class="linenos">125</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="Logistic_Regression_Guard-126"><a href="#Logistic_Regression_Guard-126"><span class="linenos">126</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="Logistic_Regression_Guard-127"><a href="#Logistic_Regression_Guard-127"><span class="linenos">127</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard-128"><a href="#Logistic_Regression_Guard-128"><span class="linenos">128</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="Logistic_Regression_Guard-129"><a href="#Logistic_Regression_Guard-129"><span class="linenos">129</span></a><span class="sd">            &gt;&gt;&gt; y_prediction = guard.predict(X_test)</span>
</span><span id="Logistic_Regression_Guard-130"><a href="#Logistic_Regression_Guard-130"><span class="linenos">130</span></a>
</span><span id="Logistic_Regression_Guard-131"><a href="#Logistic_Regression_Guard-131"><span class="linenos">131</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard-132"><a href="#Logistic_Regression_Guard-132"><span class="linenos">132</span></a>
</span><span id="Logistic_Regression_Guard-133"><a href="#Logistic_Regression_Guard-133"><span class="linenos">133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard-134"><a href="#Logistic_Regression_Guard-134"><span class="linenos">134</span></a>        <span class="c1"># scale numerical attributes</span>
</span><span id="Logistic_Regression_Guard-135"><a href="#Logistic_Regression_Guard-135"><span class="linenos">135</span></a>        <span class="n">input_instances</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span>
</span><span id="Logistic_Regression_Guard-136"><a href="#Logistic_Regression_Guard-136"><span class="linenos">136</span></a>            <span class="n">input_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-137"><a href="#Logistic_Regression_Guard-137"><span class="linenos">137</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard-138"><a href="#Logistic_Regression_Guard-138"><span class="linenos">138</span></a>        <span class="n">input_instances</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">input_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-139"><a href="#Logistic_Regression_Guard-139"><span class="linenos">139</span></a>
</span><span id="Logistic_Regression_Guard-140"><a href="#Logistic_Regression_Guard-140"><span class="linenos">140</span></a>        <span class="n">predicted_transition_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_instances</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-141"><a href="#Logistic_Regression_Guard-141"><span class="linenos">141</span></a>        <span class="c1"># ty stackoverflow</span>
</span><span id="Logistic_Regression_Guard-142"><a href="#Logistic_Regression_Guard-142"><span class="linenos">142</span></a>        <span class="c1"># finds the key (transition) where the value (transition integer / id) corresponds to the predicted integer / id</span>
</span><span id="Logistic_Regression_Guard-143"><a href="#Logistic_Regression_Guard-143"><span class="linenos">143</span></a>        <span class="c1"># for all predicted integers</span>
</span><span id="Logistic_Regression_Guard-144"><a href="#Logistic_Regression_Guard-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">trans</span> <span class="k">for</span> <span class="n">trans</span><span class="p">,</span> <span class="n">trans_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">trans_id</span> <span class="o">==</span> <span class="n">pred_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">pred_id</span> <span class="ow">in</span> <span class="n">predicted_transition_ids</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard-145"><a href="#Logistic_Regression_Guard-145"><span class="linenos">145</span></a>
</span><span id="Logistic_Regression_Guard-146"><a href="#Logistic_Regression_Guard-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">is_explainable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-147"><a href="#Logistic_Regression_Guard-147"><span class="linenos">147</span></a>        <span class="sd">&quot;&quot;&quot;Returns whether or not this guard is explainable.</span>
</span><span id="Logistic_Regression_Guard-148"><a href="#Logistic_Regression_Guard-148"><span class="linenos">148</span></a>
</span><span id="Logistic_Regression_Guard-149"><a href="#Logistic_Regression_Guard-149"><span class="linenos">149</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard-150"><a href="#Logistic_Regression_Guard-150"><span class="linenos">150</span></a><span class="sd">            bool: Whether or not the guard is explainable.</span>
</span><span id="Logistic_Regression_Guard-151"><a href="#Logistic_Regression_Guard-151"><span class="linenos">151</span></a>
</span><span id="Logistic_Regression_Guard-152"><a href="#Logistic_Regression_Guard-152"><span class="linenos">152</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard-153"><a href="#Logistic_Regression_Guard-153"><span class="linenos">153</span></a><span class="sd">            </span>
</span><span id="Logistic_Regression_Guard-154"><a href="#Logistic_Regression_Guard-154"><span class="linenos">154</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard-155"><a href="#Logistic_Regression_Guard-155"><span class="linenos">155</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard-156"><a href="#Logistic_Regression_Guard-156"><span class="linenos">156</span></a><span class="sd">            &gt;&gt;&gt; guard.is_explainable()</span>
</span><span id="Logistic_Regression_Guard-157"><a href="#Logistic_Regression_Guard-157"><span class="linenos">157</span></a><span class="sd">            True</span>
</span><span id="Logistic_Regression_Guard-158"><a href="#Logistic_Regression_Guard-158"><span class="linenos">158</span></a>
</span><span id="Logistic_Regression_Guard-159"><a href="#Logistic_Regression_Guard-159"><span class="linenos">159</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard-160"><a href="#Logistic_Regression_Guard-160"><span class="linenos">160</span></a>
</span><span id="Logistic_Regression_Guard-161"><a href="#Logistic_Regression_Guard-161"><span class="linenos">161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard-162"><a href="#Logistic_Regression_Guard-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Logistic_Regression_Guard-163"><a href="#Logistic_Regression_Guard-163"><span class="linenos">163</span></a>
</span><span id="Logistic_Regression_Guard-164"><a href="#Logistic_Regression_Guard-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">get_explainable_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-165"><a href="#Logistic_Regression_Guard-165"><span class="linenos">165</span></a>        <span class="sd">&quot;&quot;&quot;Returns an explainable representation of the logistic regression guard, a Matplotlib plot using SHAP.</span>
</span><span id="Logistic_Regression_Guard-166"><a href="#Logistic_Regression_Guard-166"><span class="linenos">166</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard-167"><a href="#Logistic_Regression_Guard-167"><span class="linenos">167</span></a><span class="sd">            data (DataFrame): Dataset of input instances used to construct an explainable representation.</span>
</span><span id="Logistic_Regression_Guard-168"><a href="#Logistic_Regression_Guard-168"><span class="linenos">168</span></a>
</span><span id="Logistic_Regression_Guard-169"><a href="#Logistic_Regression_Guard-169"><span class="linenos">169</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard-170"><a href="#Logistic_Regression_Guard-170"><span class="linenos">170</span></a><span class="sd">            Figure: Matplotlib Figure of the trained logistic regression model.</span>
</span><span id="Logistic_Regression_Guard-171"><a href="#Logistic_Regression_Guard-171"><span class="linenos">171</span></a>
</span><span id="Logistic_Regression_Guard-172"><a href="#Logistic_Regression_Guard-172"><span class="linenos">172</span></a><span class="sd">        Raises:</span>
</span><span id="Logistic_Regression_Guard-173"><a href="#Logistic_Regression_Guard-173"><span class="linenos">173</span></a><span class="sd">            Exception: If guard has no explainable representation.</span>
</span><span id="Logistic_Regression_Guard-174"><a href="#Logistic_Regression_Guard-174"><span class="linenos">174</span></a>
</span><span id="Logistic_Regression_Guard-175"><a href="#Logistic_Regression_Guard-175"><span class="linenos">175</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard-176"><a href="#Logistic_Regression_Guard-176"><span class="linenos">176</span></a>
</span><span id="Logistic_Regression_Guard-177"><a href="#Logistic_Regression_Guard-177"><span class="linenos">177</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="Logistic_Regression_Guard-178"><a href="#Logistic_Regression_Guard-178"><span class="linenos">178</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="Logistic_Regression_Guard-179"><a href="#Logistic_Regression_Guard-179"><span class="linenos">179</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="Logistic_Regression_Guard-180"><a href="#Logistic_Regression_Guard-180"><span class="linenos">180</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard-181"><a href="#Logistic_Regression_Guard-181"><span class="linenos">181</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="Logistic_Regression_Guard-182"><a href="#Logistic_Regression_Guard-182"><span class="linenos">182</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="Logistic_Regression_Guard-183"><a href="#Logistic_Regression_Guard-183"><span class="linenos">183</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="Logistic_Regression_Guard-184"><a href="#Logistic_Regression_Guard-184"><span class="linenos">184</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="Logistic_Regression_Guard-185"><a href="#Logistic_Regression_Guard-185"><span class="linenos">185</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="Logistic_Regression_Guard-186"><a href="#Logistic_Regression_Guard-186"><span class="linenos">186</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="Logistic_Regression_Guard-187"><a href="#Logistic_Regression_Guard-187"><span class="linenos">187</span></a><span class="sd">            &gt;&gt;&gt; # select a certain decision point and the corresponding data set </span>
</span><span id="Logistic_Regression_Guard-188"><a href="#Logistic_Regression_Guard-188"><span class="linenos">188</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="Logistic_Regression_Guard-189"><a href="#Logistic_Regression_Guard-189"><span class="linenos">189</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="Logistic_Regression_Guard-190"><a href="#Logistic_Regression_Guard-190"><span class="linenos">190</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="Logistic_Regression_Guard-191"><a href="#Logistic_Regression_Guard-191"><span class="linenos">191</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard-192"><a href="#Logistic_Regression_Guard-192"><span class="linenos">192</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="Logistic_Regression_Guard-193"><a href="#Logistic_Regression_Guard-193"><span class="linenos">193</span></a><span class="sd">            &gt;&gt;&gt; y_prediction = guard.predict(X_test)</span>
</span><span id="Logistic_Regression_Guard-194"><a href="#Logistic_Regression_Guard-194"><span class="linenos">194</span></a><span class="sd">            &gt;&gt;&gt; # return figure of explainable representation</span>
</span><span id="Logistic_Regression_Guard-195"><a href="#Logistic_Regression_Guard-195"><span class="linenos">195</span></a><span class="sd">            &gt;&gt;&gt; fig = guard.get_explainable_representation(X_test) # results may deviate </span>
</span><span id="Logistic_Regression_Guard-196"><a href="#Logistic_Regression_Guard-196"><span class="linenos">196</span></a><span class="sd">            </span>
</span><span id="Logistic_Regression_Guard-197"><a href="#Logistic_Regression_Guard-197"><span class="linenos">197</span></a><span class="sd">            &lt;img src=&quot;../../images/lr-example-representation.svg&quot; alt=&quot;Example explainable representation of a logistic regression guard&quot; style=&quot;max-height: 350px;&quot;/&gt;</span>
</span><span id="Logistic_Regression_Guard-198"><a href="#Logistic_Regression_Guard-198"><span class="linenos">198</span></a>
</span><span id="Logistic_Regression_Guard-199"><a href="#Logistic_Regression_Guard-199"><span class="linenos">199</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard-200"><a href="#Logistic_Regression_Guard-200"><span class="linenos">200</span></a>
</span><span id="Logistic_Regression_Guard-201"><a href="#Logistic_Regression_Guard-201"><span class="linenos">201</span></a><span class="sd">        Note: </span>
</span><span id="Logistic_Regression_Guard-202"><a href="#Logistic_Regression_Guard-202"><span class="linenos">202</span></a><span class="sd">            For an example of the explainable representations of all machine learning techniques please check [Data Petri Net Example](https://github.com/aarkue/eXdpn/blob/main/docs/dpn_example.ipynb).</span>
</span><span id="Logistic_Regression_Guard-203"><a href="#Logistic_Regression_Guard-203"><span class="linenos">203</span></a>
</span><span id="Logistic_Regression_Guard-204"><a href="#Logistic_Regression_Guard-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard-205"><a href="#Logistic_Regression_Guard-205"><span class="linenos">205</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_explainable</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-206"><a href="#Logistic_Regression_Guard-206"><span class="linenos">206</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="Logistic_Regression_Guard-207"><a href="#Logistic_Regression_Guard-207"><span class="linenos">207</span></a>                <span class="s2">&quot;Guard is not explainable and therefore has no explainable representation&quot;</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-208"><a href="#Logistic_Regression_Guard-208"><span class="linenos">208</span></a>
</span><span id="Logistic_Regression_Guard-209"><a href="#Logistic_Regression_Guard-209"><span class="linenos">209</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="Logistic_Regression_Guard-210"><a href="#Logistic_Regression_Guard-210"><span class="linenos">210</span></a>                   <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Logistic_Regression_Guard-211"><a href="#Logistic_Regression_Guard-211"><span class="linenos">211</span></a>
</span><span id="Logistic_Regression_Guard-212"><a href="#Logistic_Regression_Guard-212"><span class="linenos">212</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-213"><a href="#Logistic_Regression_Guard-213"><span class="linenos">213</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard-214"><a href="#Logistic_Regression_Guard-214"><span class="linenos">214</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-215"><a href="#Logistic_Regression_Guard-215"><span class="linenos">215</span></a>        
</span><span id="Logistic_Regression_Guard-216"><a href="#Logistic_Regression_Guard-216"><span class="linenos">216</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">LinearExplainer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-217"><a href="#Logistic_Regression_Guard-217"><span class="linenos">217</span></a>
</span><span id="Logistic_Regression_Guard-218"><a href="#Logistic_Regression_Guard-218"><span class="linenos">218</span></a>        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-219"><a href="#Logistic_Regression_Guard-219"><span class="linenos">219</span></a>
</span><span id="Logistic_Regression_Guard-220"><a href="#Logistic_Regression_Guard-220"><span class="linenos">220</span></a>        <span class="c1"># Docs for this summary plot: https://shap-lrjball.readthedocs.io/en/latest/generated/shap.summary_plot.html</span>
</span><span id="Logistic_Regression_Guard-221"><a href="#Logistic_Regression_Guard-221"><span class="linenos">221</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-222"><a href="#Logistic_Regression_Guard-222"><span class="linenos">222</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-223"><a href="#Logistic_Regression_Guard-223"><span class="linenos">223</span></a>                            <span class="n">data</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-224"><a href="#Logistic_Regression_Guard-224"><span class="linenos">224</span></a>                            <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-225"><a href="#Logistic_Regression_Guard-225"><span class="linenos">225</span></a>                            <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-226"><a href="#Logistic_Regression_Guard-226"><span class="linenos">226</span></a>                            <span class="n">class_names</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-227"><a href="#Logistic_Regression_Guard-227"><span class="linenos">227</span></a>                            <span class="n">class_inds</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)))</span>
</span><span id="Logistic_Regression_Guard-228"><a href="#Logistic_Regression_Guard-228"><span class="linenos">228</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feature Impact on Model Prediction&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-229"><a href="#Logistic_Regression_Guard-229"><span class="linenos">229</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Feature Attributes&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-230"><a href="#Logistic_Regression_Guard-230"><span class="linenos">230</span></a>
</span><span id="Logistic_Regression_Guard-231"><a href="#Logistic_Regression_Guard-231"><span class="linenos">231</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard-232"><a href="#Logistic_Regression_Guard-232"><span class="linenos">232</span></a>
</span><span id="Logistic_Regression_Guard-233"><a href="#Logistic_Regression_Guard-233"><span class="linenos">233</span></a>    <span class="k">def</span> <span class="nf">get_global_explanations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_sample</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Union</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="Logistic_Regression_Guard-234"><a href="#Logistic_Regression_Guard-234"><span class="linenos">234</span></a>        <span class="sd">&quot;&quot;&quot;Get a global explainable representation for the concrete machine learning classifier.</span>
</span><span id="Logistic_Regression_Guard-235"><a href="#Logistic_Regression_Guard-235"><span class="linenos">235</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard-236"><a href="#Logistic_Regression_Guard-236"><span class="linenos">236</span></a><span class="sd">            base_sample (DataFrame): A small (10-30) sample of the population for this decision point; Used for calculation of shap values.</span>
</span><span id="Logistic_Regression_Guard-237"><a href="#Logistic_Regression_Guard-237"><span class="linenos">237</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard-238"><a href="#Logistic_Regression_Guard-238"><span class="linenos">238</span></a><span class="sd">            Dict[str,Figure]: A dictionary containing the global explainable representations. Containing the following entries:</span>
</span><span id="Logistic_Regression_Guard-239"><a href="#Logistic_Regression_Guard-239"><span class="linenos">239</span></a><span class="sd">            - &quot;Bar plot (Summary)&quot;</span>
</span><span id="Logistic_Regression_Guard-240"><a href="#Logistic_Regression_Guard-240"><span class="linenos">240</span></a><span class="sd">            - &quot;Beeswarm plot for `X`&quot; (for all output labels X)</span>
</span><span id="Logistic_Regression_Guard-241"><a href="#Logistic_Regression_Guard-241"><span class="linenos">241</span></a><span class="sd">            - &quot;Force plot for `X`&quot; (for all output labels X)</span>
</span><span id="Logistic_Regression_Guard-242"><a href="#Logistic_Regression_Guard-242"><span class="linenos">242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard-243"><a href="#Logistic_Regression_Guard-243"><span class="linenos">243</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-244"><a href="#Logistic_Regression_Guard-244"><span class="linenos">244</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard-245"><a href="#Logistic_Regression_Guard-245"><span class="linenos">245</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-246"><a href="#Logistic_Regression_Guard-246"><span class="linenos">246</span></a>        <span class="n">unscaled_base_sample</span> <span class="o">=</span> <span class="n">processed_base_sample</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-247"><a href="#Logistic_Regression_Guard-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-248"><a href="#Logistic_Regression_Guard-248"><span class="linenos">248</span></a>            <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">unscaled_base_sample</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Logistic_Regression_Guard-249"><a href="#Logistic_Regression_Guard-249"><span class="linenos">249</span></a>                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">():</span>
</span><span id="Logistic_Regression_Guard-250"><a href="#Logistic_Regression_Guard-250"><span class="linenos">250</span></a>                    <span class="n">row</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_sample</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard-251"><a href="#Logistic_Regression_Guard-251"><span class="linenos">251</span></a>        <span class="k">def</span> <span class="nf">shap_predict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="Logistic_Regression_Guard-252"><a href="#Logistic_Regression_Guard-252"><span class="linenos">252</span></a>            <span class="n">data_asframe</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-253"><a href="#Logistic_Regression_Guard-253"><span class="linenos">253</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">data_asframe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-254"><a href="#Logistic_Regression_Guard-254"><span class="linenos">254</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="Logistic_Regression_Guard-255"><a href="#Logistic_Regression_Guard-255"><span class="linenos">255</span></a>
</span><span id="Logistic_Regression_Guard-256"><a href="#Logistic_Regression_Guard-256"><span class="linenos">256</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">shap_predict</span><span class="p">,</span> <span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-257"><a href="#Logistic_Regression_Guard-257"><span class="linenos">257</span></a>        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">l1_reg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;num_features(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-258"><a href="#Logistic_Regression_Guard-258"><span class="linenos">258</span></a>        <span class="c1"># shap_values = explainer.shap_values(processed_base_sample)</span>
</span><span id="Logistic_Regression_Guard-259"><a href="#Logistic_Regression_Guard-259"><span class="linenos">259</span></a>        <span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="Logistic_Regression_Guard-260"><a href="#Logistic_Regression_Guard-260"><span class="linenos">260</span></a>                        <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Logistic_Regression_Guard-261"><a href="#Logistic_Regression_Guard-261"><span class="linenos">261</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-262"><a href="#Logistic_Regression_Guard-262"><span class="linenos">262</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-263"><a href="#Logistic_Regression_Guard-263"><span class="linenos">263</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-264"><a href="#Logistic_Regression_Guard-264"><span class="linenos">264</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span> <span class="n">unscaled_base_sample</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span> <span class="n">use_log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">max_display</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-265"><a href="#Logistic_Regression_Guard-265"><span class="linenos">265</span></a>        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Bar plot (Summary)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="p">;</span>
</span><span id="Logistic_Regression_Guard-266"><a href="#Logistic_Regression_Guard-266"><span class="linenos">266</span></a>
</span><span id="Logistic_Regression_Guard-267"><a href="#Logistic_Regression_Guard-267"><span class="linenos">267</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_names</span><span class="p">)):</span>
</span><span id="Logistic_Regression_Guard-268"><a href="#Logistic_Regression_Guard-268"><span class="linenos">268</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="Logistic_Regression_Guard-269"><a href="#Logistic_Regression_Guard-269"><span class="linenos">269</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-270"><a href="#Logistic_Regression_Guard-270"><span class="linenos">270</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">beeswarm</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">Explanation</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">shap_values</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
</span><span id="Logistic_Regression_Guard-271"><a href="#Logistic_Regression_Guard-271"><span class="linenos">271</span></a>                                                            <span class="n">base_values</span><span class="o">=</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">unscaled_base_sample</span><span class="p">,</span>  
</span><span id="Logistic_Regression_Guard-272"><a href="#Logistic_Regression_Guard-272"><span class="linenos">272</span></a>                                                    <span class="n">feature_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-273"><a href="#Logistic_Regression_Guard-273"><span class="linenos">273</span></a>                                                    <span class="n">order</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)))</span>
</span><span id="Logistic_Regression_Guard-274"><a href="#Logistic_Regression_Guard-274"><span class="linenos">274</span></a>            <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-275"><a href="#Logistic_Regression_Guard-275"><span class="linenos">275</span></a>            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-276"><a href="#Logistic_Regression_Guard-276"><span class="linenos">276</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Beeswarm plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard-277"><a href="#Logistic_Regression_Guard-277"><span class="linenos">277</span></a>
</span><span id="Logistic_Regression_Guard-278"><a href="#Logistic_Regression_Guard-278"><span class="linenos">278</span></a>            <span class="n">force_plot</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">force_plot</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[[</span><span class="n">key</span><span class="p">]],</span><span class="n">shap_values</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">features</span><span class="o">=</span><span class="n">unscaled_base_sample</span><span class="p">,</span> <span class="n">out_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-279"><a href="#Logistic_Regression_Guard-279"><span class="linenos">279</span></a>            <span class="n">html_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-280"><a href="#Logistic_Regression_Guard-280"><span class="linenos">280</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">save_html</span><span class="p">(</span><span class="n">html_data</span><span class="p">,</span><span class="n">force_plot</span><span class="p">,</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-281"><a href="#Logistic_Regression_Guard-281"><span class="linenos">281</span></a>            <span class="n">html_data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># rewind the data</span>
</span><span id="Logistic_Regression_Guard-282"><a href="#Logistic_Regression_Guard-282"><span class="linenos">282</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Force plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">html_data</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-283"><a href="#Logistic_Regression_Guard-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="Logistic_Regression_Guard-284"><a href="#Logistic_Regression_Guard-284"><span class="linenos">284</span></a>
</span><span id="Logistic_Regression_Guard-285"><a href="#Logistic_Regression_Guard-285"><span class="linenos">285</span></a>
</span><span id="Logistic_Regression_Guard-286"><a href="#Logistic_Regression_Guard-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="nf">get_local_explanations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">local_data</span><span class="p">:</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">base_sample</span><span class="p">:</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Figure</span><span class="p">]:</span>
</span><span id="Logistic_Regression_Guard-287"><a href="#Logistic_Regression_Guard-287"><span class="linenos">287</span></a>        <span class="sd">&quot;&quot;&quot;Get explainable representations for a single decision situation. </span>
</span><span id="Logistic_Regression_Guard-288"><a href="#Logistic_Regression_Guard-288"><span class="linenos">288</span></a>
</span><span id="Logistic_Regression_Guard-289"><a href="#Logistic_Regression_Guard-289"><span class="linenos">289</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard-290"><a href="#Logistic_Regression_Guard-290"><span class="linenos">290</span></a><span class="sd">            local_data (DataFrame): A dataframe containing the single decision situation.</span>
</span><span id="Logistic_Regression_Guard-291"><a href="#Logistic_Regression_Guard-291"><span class="linenos">291</span></a><span class="sd">            base_sample (DataFrame): A small (10-30) sample of the population for this decision point; Used for calculation of shap values.</span>
</span><span id="Logistic_Regression_Guard-292"><a href="#Logistic_Regression_Guard-292"><span class="linenos">292</span></a>
</span><span id="Logistic_Regression_Guard-293"><a href="#Logistic_Regression_Guard-293"><span class="linenos">293</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard-294"><a href="#Logistic_Regression_Guard-294"><span class="linenos">294</span></a><span class="sd">            Dict[str,Figure]: A dictionary containing the explainable representations for the single decision situation. Containing the following entries:</span>
</span><span id="Logistic_Regression_Guard-295"><a href="#Logistic_Regression_Guard-295"><span class="linenos">295</span></a><span class="sd">            - &quot;Decision plot (Multioutput)&quot;</span>
</span><span id="Logistic_Regression_Guard-296"><a href="#Logistic_Regression_Guard-296"><span class="linenos">296</span></a><span class="sd">            - &quot;Decision plot for `X`&quot; (for all output labels X)</span>
</span><span id="Logistic_Regression_Guard-297"><a href="#Logistic_Regression_Guard-297"><span class="linenos">297</span></a><span class="sd">            - &quot;Force plot for `X`&quot; (for all output labels X)</span>
</span><span id="Logistic_Regression_Guard-298"><a href="#Logistic_Regression_Guard-298"><span class="linenos">298</span></a><span class="sd">                </span>
</span><span id="Logistic_Regression_Guard-299"><a href="#Logistic_Regression_Guard-299"><span class="linenos">299</span></a><span class="sd">        &quot;&quot;&quot;</span>  
</span><span id="Logistic_Regression_Guard-300"><a href="#Logistic_Regression_Guard-300"><span class="linenos">300</span></a>
</span><span id="Logistic_Regression_Guard-301"><a href="#Logistic_Regression_Guard-301"><span class="linenos">301</span></a>        <span class="k">assert</span> <span class="n">local_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="Logistic_Regression_Guard-302"><a href="#Logistic_Regression_Guard-302"><span class="linenos">302</span></a>        <span class="c1"># Pre-process local_data</span>
</span><span id="Logistic_Regression_Guard-303"><a href="#Logistic_Regression_Guard-303"><span class="linenos">303</span></a>        <span class="c1"># Scale data</span>
</span><span id="Logistic_Regression_Guard-304"><a href="#Logistic_Regression_Guard-304"><span class="linenos">304</span></a>        <span class="n">processed_local_data</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">local_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-305"><a href="#Logistic_Regression_Guard-305"><span class="linenos">305</span></a>        <span class="c1"># One-Hot Encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard-306"><a href="#Logistic_Regression_Guard-306"><span class="linenos">306</span></a>        <span class="n">processed_local_data</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-307"><a href="#Logistic_Regression_Guard-307"><span class="linenos">307</span></a>        
</span><span id="Logistic_Regression_Guard-308"><a href="#Logistic_Regression_Guard-308"><span class="linenos">308</span></a>        <span class="c1"># Pre-process base_sample</span>
</span><span id="Logistic_Regression_Guard-309"><a href="#Logistic_Regression_Guard-309"><span class="linenos">309</span></a>        <span class="c1"># Scale data</span>
</span><span id="Logistic_Regression_Guard-310"><a href="#Logistic_Regression_Guard-310"><span class="linenos">310</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-311"><a href="#Logistic_Regression_Guard-311"><span class="linenos">311</span></a>        <span class="c1"># One-Hot Encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard-312"><a href="#Logistic_Regression_Guard-312"><span class="linenos">312</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-313"><a href="#Logistic_Regression_Guard-313"><span class="linenos">313</span></a>
</span><span id="Logistic_Regression_Guard-314"><a href="#Logistic_Regression_Guard-314"><span class="linenos">314</span></a>        <span class="c1"># transitions_labels =  {i: n for n,i in self.transition_int_map.items()}</span>
</span><span id="Logistic_Regression_Guard-315"><a href="#Logistic_Regression_Guard-315"><span class="linenos">315</span></a>        <span class="c1"># target_names = [transitions_labels[i] for i in sorted(transitions_labels.keys())]</span>
</span><span id="Logistic_Regression_Guard-316"><a href="#Logistic_Regression_Guard-316"><span class="linenos">316</span></a>        <span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="Logistic_Regression_Guard-317"><a href="#Logistic_Regression_Guard-317"><span class="linenos">317</span></a>                   <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Logistic_Regression_Guard-318"><a href="#Logistic_Regression_Guard-318"><span class="linenos">318</span></a>        <span class="k">def</span> <span class="nf">shap_predict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="Logistic_Regression_Guard-319"><a href="#Logistic_Regression_Guard-319"><span class="linenos">319</span></a>            <span class="n">data_asframe</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-320"><a href="#Logistic_Regression_Guard-320"><span class="linenos">320</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">data_asframe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-321"><a href="#Logistic_Regression_Guard-321"><span class="linenos">321</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="Logistic_Regression_Guard-322"><a href="#Logistic_Regression_Guard-322"><span class="linenos">322</span></a>
</span><span id="Logistic_Regression_Guard-323"><a href="#Logistic_Regression_Guard-323"><span class="linenos">323</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">shap_predict</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-324"><a href="#Logistic_Regression_Guard-324"><span class="linenos">324</span></a>
</span><span id="Logistic_Regression_Guard-325"><a href="#Logistic_Regression_Guard-325"><span class="linenos">325</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span>
</span><span id="Logistic_Regression_Guard-326"><a href="#Logistic_Regression_Guard-326"><span class="linenos">326</span></a>            <span class="n">shap_predict</span><span class="p">,</span> <span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-327"><a href="#Logistic_Regression_Guard-327"><span class="linenos">327</span></a>        <span class="n">single_shap</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">l1_reg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;num_features(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-328"><a href="#Logistic_Regression_Guard-328"><span class="linenos">328</span></a>        
</span><span id="Logistic_Regression_Guard-329"><a href="#Logistic_Regression_Guard-329"><span class="linenos">329</span></a>        <span class="n">unscaled_local_data</span> <span class="o">=</span> <span class="n">processed_local_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard-330"><a href="#Logistic_Regression_Guard-330"><span class="linenos">330</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard-331"><a href="#Logistic_Regression_Guard-331"><span class="linenos">331</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">():</span>
</span><span id="Logistic_Regression_Guard-332"><a href="#Logistic_Regression_Guard-332"><span class="linenos">332</span></a>                <span class="n">unscaled_local_data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">local_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard-333"><a href="#Logistic_Regression_Guard-333"><span class="linenos">333</span></a>
</span><span id="Logistic_Regression_Guard-334"><a href="#Logistic_Regression_Guard-334"><span class="linenos">334</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-335"><a href="#Logistic_Regression_Guard-335"><span class="linenos">335</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-336"><a href="#Logistic_Regression_Guard-336"><span class="linenos">336</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">multioutput_decision_plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">),</span><span class="n">single_shap</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-337"><a href="#Logistic_Regression_Guard-337"><span class="linenos">337</span></a>        <span class="n">features</span><span class="o">=</span><span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">row_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-338"><a href="#Logistic_Regression_Guard-338"><span class="linenos">338</span></a>        <span class="n">highlight</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-339"><a href="#Logistic_Regression_Guard-339"><span class="linenos">339</span></a>        <span class="n">legend_location</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> <span class="n">feature_display_range</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-340"><a href="#Logistic_Regression_Guard-340"><span class="linenos">340</span></a>        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Decision plot (Multioutput)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard-341"><a href="#Logistic_Regression_Guard-341"><span class="linenos">341</span></a>        
</span><span id="Logistic_Regression_Guard-342"><a href="#Logistic_Regression_Guard-342"><span class="linenos">342</span></a>        
</span><span id="Logistic_Regression_Guard-343"><a href="#Logistic_Regression_Guard-343"><span class="linenos">343</span></a>        <span class="n">winner_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Logistic_Regression_Guard-344"><a href="#Logistic_Regression_Guard-344"><span class="linenos">344</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">single_shap</span><span class="p">)):</span>
</span><span id="Logistic_Regression_Guard-345"><a href="#Logistic_Regression_Guard-345"><span class="linenos">345</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-346"><a href="#Logistic_Regression_Guard-346"><span class="linenos">346</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">decision_plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">)[</span><span class="n">key</span><span class="p">],</span><span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">features</span><span class="o">=</span><span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-347"><a href="#Logistic_Regression_Guard-347"><span class="linenos">347</span></a>            <span class="n">legend_labels</span><span class="o">=</span><span class="p">[</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]],</span> <span class="n">feature_display_range</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">highlight</span><span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">winner_index</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="p">)</span>
</span><span id="Logistic_Regression_Guard-348"><a href="#Logistic_Regression_Guard-348"><span class="linenos">348</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Decision plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard-349"><a href="#Logistic_Regression_Guard-349"><span class="linenos">349</span></a>
</span><span id="Logistic_Regression_Guard-350"><a href="#Logistic_Regression_Guard-350"><span class="linenos">350</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-351"><a href="#Logistic_Regression_Guard-351"><span class="linenos">351</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">beeswarm</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">Explanation</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
</span><span id="Logistic_Regression_Guard-352"><a href="#Logistic_Regression_Guard-352"><span class="linenos">352</span></a>                                                            <span class="n">base_values</span><span class="o">=</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">processed_local_data</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-353"><a href="#Logistic_Regression_Guard-353"><span class="linenos">353</span></a>                                                            <span class="n">order</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)))</span>
</span><span id="Logistic_Regression_Guard-354"><a href="#Logistic_Regression_Guard-354"><span class="linenos">354</span></a>            <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-355"><a href="#Logistic_Regression_Guard-355"><span class="linenos">355</span></a>            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-356"><a href="#Logistic_Regression_Guard-356"><span class="linenos">356</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;WIP: Beeswarm plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard-357"><a href="#Logistic_Regression_Guard-357"><span class="linenos">357</span></a>
</span><span id="Logistic_Regression_Guard-358"><a href="#Logistic_Regression_Guard-358"><span class="linenos">358</span></a>
</span><span id="Logistic_Regression_Guard-359"><a href="#Logistic_Regression_Guard-359"><span class="linenos">359</span></a>            <span class="c1"># fig = plt.figure()</span>
</span><span id="Logistic_Regression_Guard-360"><a href="#Logistic_Regression_Guard-360"><span class="linenos">360</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">force_plot</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
</span><span id="Logistic_Regression_Guard-361"><a href="#Logistic_Regression_Guard-361"><span class="linenos">361</span></a>                            <span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
</span><span id="Logistic_Regression_Guard-362"><a href="#Logistic_Regression_Guard-362"><span class="linenos">362</span></a>                            <span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">out_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">matplotlib</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard-363"><a href="#Logistic_Regression_Guard-363"><span class="linenos">363</span></a>                            <span class="c1"># link=&#39;logit&#39;,</span>
</span><span id="Logistic_Regression_Guard-364"><a href="#Logistic_Regression_Guard-364"><span class="linenos">364</span></a>                            <span class="n">contribution_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard-365"><a href="#Logistic_Regression_Guard-365"><span class="linenos">365</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard-366"><a href="#Logistic_Regression_Guard-366"><span class="linenos">366</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Force plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard-367"><a href="#Logistic_Regression_Guard-367"><span class="linenos">367</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


    

                            <div id="Logistic_Regression_Guard.__init__" class="classattr">
                                        <input id="Logistic_Regression_Guard.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Logistic_Regression_Guard</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">hyperparameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.1375</span><span class="p">,</span> <span class="s1">&#39;tol&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}</span>,</span><span class="param">	<span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Logistic_Regression_Guard.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Logistic_Regression_Guard.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Logistic_Regression_Guard.__init__-23"><a href="#Logistic_Regression_Guard.__init__-23"><span class="linenos">23</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.1375</span><span class="p">,</span> <span class="s1">&#39;tol&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">},</span> <span class="n">random_state</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.__init__-24"><a href="#Logistic_Regression_Guard.__init__-24"><span class="linenos">24</span></a>        <span class="sd">&quot;&quot;&quot;Initializes a logistic regression based guard with the provided hyperparameters.</span>
</span><span id="Logistic_Regression_Guard.__init__-25"><a href="#Logistic_Regression_Guard.__init__-25"><span class="linenos">25</span></a>
</span><span id="Logistic_Regression_Guard.__init__-26"><a href="#Logistic_Regression_Guard.__init__-26"><span class="linenos">26</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard.__init__-27"><a href="#Logistic_Regression_Guard.__init__-27"><span class="linenos">27</span></a><span class="sd">            hyperparameters (Dict[str, Any]): Hyperparameters used for the classifier.</span>
</span><span id="Logistic_Regression_Guard.__init__-28"><a href="#Logistic_Regression_Guard.__init__-28"><span class="linenos">28</span></a><span class="sd">            random_state (int, optional): The random state to be used for algorithms wherever possible. Defaults to None.</span>
</span><span id="Logistic_Regression_Guard.__init__-29"><a href="#Logistic_Regression_Guard.__init__-29"><span class="linenos">29</span></a>
</span><span id="Logistic_Regression_Guard.__init__-30"><a href="#Logistic_Regression_Guard.__init__-30"><span class="linenos">30</span></a><span class="sd">        Raises:</span>
</span><span id="Logistic_Regression_Guard.__init__-31"><a href="#Logistic_Regression_Guard.__init__-31"><span class="linenos">31</span></a><span class="sd">            TypeError: If supplied hyperparameters are invalid.</span>
</span><span id="Logistic_Regression_Guard.__init__-32"><a href="#Logistic_Regression_Guard.__init__-32"><span class="linenos">32</span></a>
</span><span id="Logistic_Regression_Guard.__init__-33"><a href="#Logistic_Regression_Guard.__init__-33"><span class="linenos">33</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard.__init__-34"><a href="#Logistic_Regression_Guard.__init__-34"><span class="linenos">34</span></a><span class="sd">            </span>
</span><span id="Logistic_Regression_Guard.__init__-35"><a href="#Logistic_Regression_Guard.__init__-35"><span class="linenos">35</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard.__init__-36"><a href="#Logistic_Regression_Guard.__init__-36"><span class="linenos">36</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard.__init__-37"><a href="#Logistic_Regression_Guard.__init__-37"><span class="linenos">37</span></a>
</span><span id="Logistic_Regression_Guard.__init__-38"><a href="#Logistic_Regression_Guard.__init__-38"><span class="linenos">38</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard.__init__-39"><a href="#Logistic_Regression_Guard.__init__-39"><span class="linenos">39</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard.__init__-40"><a href="#Logistic_Regression_Guard.__init__-40"><span class="linenos">40</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">hyperparameters</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.__init__-41"><a href="#Logistic_Regression_Guard.__init__-41"><span class="linenos">41</span></a>        <span class="c1"># possible hyperparameter: C (regularization parameter)</span>
</span><span id="Logistic_Regression_Guard.__init__-42"><a href="#Logistic_Regression_Guard.__init__-42"><span class="linenos">42</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.__init__-43"><a href="#Logistic_Regression_Guard.__init__-43"><span class="linenos">43</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="o">**</span><span class="n">hyperparameters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.__init__-44"><a href="#Logistic_Regression_Guard.__init__-44"><span class="linenos">44</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.__init__-45"><a href="#Logistic_Regression_Guard.__init__-45"><span class="linenos">45</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="Logistic_Regression_Guard.__init__-46"><a href="#Logistic_Regression_Guard.__init__-46"><span class="linenos">46</span></a>                <span class="s2">&quot;Wrong hyperparameters were supplied to the logistic regression guard&quot;</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.__init__-47"><a href="#Logistic_Regression_Guard.__init__-47"><span class="linenos">47</span></a>
</span><span id="Logistic_Regression_Guard.__init__-48"><a href="#Logistic_Regression_Guard.__init__-48"><span class="linenos">48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard.__init__-49"><a href="#Logistic_Regression_Guard.__init__-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard.__init__-50"><a href="#Logistic_Regression_Guard.__init__-50"><span class="linenos">50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard.__init__-51"><a href="#Logistic_Regression_Guard.__init__-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard.__init__-52"><a href="#Logistic_Regression_Guard.__init__-52"><span class="linenos">52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Logistic_Regression_Guard.__init__-53"><a href="#Logistic_Regression_Guard.__init__-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span></pre></div>


            <div class="docstring"><p>Initializes a logistic regression based guard with the provided hyperparameters.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>hyperparameters (Dict[str, Any]):</strong>  Hyperparameters used for the classifier.</li>
<li><strong>random_state (int, optional):</strong>  The random state to be used for algorithms wherever possible. Defaults to None.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>TypeError:</strong>  If supplied hyperparameters are invalid.</li>
</ul>

<h6 id="examples">Examples</h6>

<blockquote>
  <div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../guards.html">exdpn.guards</a></span> <span class="kn">import</span> <span class="n">Logistic_Regression_Guard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span> <span class="o">=</span> <span class="n">Logistic_Regression_Guard</span><span class="p">()</span>
</code></pre></div>
  
  <p>For more examples refer to the <a href="https://aarkue.github.io/eXdpn">User Guide</a>.</p>
</blockquote>
</div>


                            </div>
                            <div id="Logistic_Regression_Guard.train" class="classattr">
                                        <input id="Logistic_Regression_Guard.train-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">train</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">X</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Logistic_Regression_Guard.train-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Logistic_Regression_Guard.train"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Logistic_Regression_Guard.train-55"><a href="#Logistic_Regression_Guard.train-55"><span class="linenos"> 55</span></a>    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.train-56"><a href="#Logistic_Regression_Guard.train-56"><span class="linenos"> 56</span></a>        <span class="sd">&quot;&quot;&quot;Trains the logistic regression guard using the dataset and the specified hyperparameters.</span>
</span><span id="Logistic_Regression_Guard.train-57"><a href="#Logistic_Regression_Guard.train-57"><span class="linenos"> 57</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard.train-58"><a href="#Logistic_Regression_Guard.train-58"><span class="linenos"> 58</span></a><span class="sd">            X (DataFrame): Feature variables of the provided dataset, used to train the classifier behind the guard.</span>
</span><span id="Logistic_Regression_Guard.train-59"><a href="#Logistic_Regression_Guard.train-59"><span class="linenos"> 59</span></a><span class="sd">            y (DataFrame): Target variable of the provided dataset, is to be predicted using `X`.</span>
</span><span id="Logistic_Regression_Guard.train-60"><a href="#Logistic_Regression_Guard.train-60"><span class="linenos"> 60</span></a>
</span><span id="Logistic_Regression_Guard.train-61"><a href="#Logistic_Regression_Guard.train-61"><span class="linenos"> 61</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard.train-62"><a href="#Logistic_Regression_Guard.train-62"><span class="linenos"> 62</span></a>
</span><span id="Logistic_Regression_Guard.train-63"><a href="#Logistic_Regression_Guard.train-63"><span class="linenos"> 63</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="Logistic_Regression_Guard.train-64"><a href="#Logistic_Regression_Guard.train-64"><span class="linenos"> 64</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="Logistic_Regression_Guard.train-65"><a href="#Logistic_Regression_Guard.train-65"><span class="linenos"> 65</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="Logistic_Regression_Guard.train-66"><a href="#Logistic_Regression_Guard.train-66"><span class="linenos"> 66</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard.train-67"><a href="#Logistic_Regression_Guard.train-67"><span class="linenos"> 67</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="Logistic_Regression_Guard.train-68"><a href="#Logistic_Regression_Guard.train-68"><span class="linenos"> 68</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="Logistic_Regression_Guard.train-69"><a href="#Logistic_Regression_Guard.train-69"><span class="linenos"> 69</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="Logistic_Regression_Guard.train-70"><a href="#Logistic_Regression_Guard.train-70"><span class="linenos"> 70</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="Logistic_Regression_Guard.train-71"><a href="#Logistic_Regression_Guard.train-71"><span class="linenos"> 71</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="Logistic_Regression_Guard.train-72"><a href="#Logistic_Regression_Guard.train-72"><span class="linenos"> 72</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="Logistic_Regression_Guard.train-73"><a href="#Logistic_Regression_Guard.train-73"><span class="linenos"> 73</span></a><span class="sd">            &gt;&gt;&gt; # select a certrain decision point and the corresponding data set </span>
</span><span id="Logistic_Regression_Guard.train-74"><a href="#Logistic_Regression_Guard.train-74"><span class="linenos"> 74</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="Logistic_Regression_Guard.train-75"><a href="#Logistic_Regression_Guard.train-75"><span class="linenos"> 75</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="Logistic_Regression_Guard.train-76"><a href="#Logistic_Regression_Guard.train-76"><span class="linenos"> 76</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="Logistic_Regression_Guard.train-77"><a href="#Logistic_Regression_Guard.train-77"><span class="linenos"> 77</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard.train-78"><a href="#Logistic_Regression_Guard.train-78"><span class="linenos"> 78</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="Logistic_Regression_Guard.train-79"><a href="#Logistic_Regression_Guard.train-79"><span class="linenos"> 79</span></a>
</span><span id="Logistic_Regression_Guard.train-80"><a href="#Logistic_Regression_Guard.train-80"><span class="linenos"> 80</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard.train-81"><a href="#Logistic_Regression_Guard.train-81"><span class="linenos"> 81</span></a>
</span><span id="Logistic_Regression_Guard.train-82"><a href="#Logistic_Regression_Guard.train-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard.train-83"><a href="#Logistic_Regression_Guard.train-83"><span class="linenos"> 83</span></a>        <span class="c1"># scale numerical attributes</span>
</span><span id="Logistic_Regression_Guard.train-84"><a href="#Logistic_Regression_Guard.train-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span> <span class="o">=</span> <span class="n">fit_scaling</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.train-85"><a href="#Logistic_Regression_Guard.train-85"><span class="linenos"> 85</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.train-86"><a href="#Logistic_Regression_Guard.train-86"><span class="linenos"> 86</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard.train-87"><a href="#Logistic_Regression_Guard.train-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span> <span class="o">=</span> <span class="n">fit_ohe</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.train-88"><a href="#Logistic_Regression_Guard.train-88"><span class="linenos"> 88</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.train-89"><a href="#Logistic_Regression_Guard.train-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="Logistic_Regression_Guard.train-90"><a href="#Logistic_Regression_Guard.train-90"><span class="linenos"> 90</span></a>
</span><span id="Logistic_Regression_Guard.train-91"><a href="#Logistic_Regression_Guard.train-91"><span class="linenos"> 91</span></a>        <span class="c1"># store feature names for the explainable representation</span>
</span><span id="Logistic_Regression_Guard.train-92"><a href="#Logistic_Regression_Guard.train-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.train-93"><a href="#Logistic_Regression_Guard.train-93"><span class="linenos"> 93</span></a>
</span><span id="Logistic_Regression_Guard.train-94"><a href="#Logistic_Regression_Guard.train-94"><span class="linenos"> 94</span></a>        <span class="c1"># make transition to integer (i.e. ID) map</span>
</span><span id="Logistic_Regression_Guard.train-95"><a href="#Logistic_Regression_Guard.train-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Logistic_Regression_Guard.train-96"><a href="#Logistic_Regression_Guard.train-96"><span class="linenos"> 96</span></a>            <span class="n">transition</span><span class="p">:</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">transition</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)))}</span>
</span><span id="Logistic_Regression_Guard.train-97"><a href="#Logistic_Regression_Guard.train-97"><span class="linenos"> 97</span></a>        <span class="n">y_transformed</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="p">[</span><span class="n">transition</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard.train-98"><a href="#Logistic_Regression_Guard.train-98"><span class="linenos"> 98</span></a>                         <span class="k">for</span> <span class="n">transition</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard.train-99"><a href="#Logistic_Regression_Guard.train-99"><span class="linenos"> 99</span></a>
</span><span id="Logistic_Regression_Guard.train-100"><a href="#Logistic_Regression_Guard.train-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_transformed</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Trains the logistic regression guard using the dataset and the specified hyperparameters.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>X (DataFrame):</strong>  Feature variables of the provided dataset, used to train the classifier behind the guard.</li>
<li><strong>y (DataFrame):</strong>  Target variable of the provided dataset, is to be predicted using <code>X</code>.</li>
</ul>

<h6 id="examples">Examples</h6>

<blockquote>
  <div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../util.html">exdpn.util</a></span> <span class="kn">import</span> <span class="n">import_log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../petri_net.html">exdpn.petri_net</a></span> <span class="kn">import</span> <span class="n">get_petri_net</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../guard_datasets.html">exdpn.guard_datasets</a></span> <span class="kn">import</span> <span class="n">extract_all_datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../guards.html">exdpn.guards</a></span> <span class="kn">import</span> <span class="n">Logistic_Regression_Guard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../data_preprocessing.html">exdpn.data_preprocessing</a></span> <span class="kn">import</span> <span class="n">data_preprocessing_evaluation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event_log</span> <span class="o">=</span> <span class="n">import_log</span><span class="p">(</span><span class="s1">&#39;./datasets/p2p_base.xes&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pn</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">fm</span> <span class="o">=</span> <span class="n">get_petri_net</span><span class="p">(</span><span class="n">event_log</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp_dataset_map</span> <span class="o">=</span> <span class="n">extract_all_datasets</span><span class="p">(</span><span class="n">event_log</span><span class="p">,</span> <span class="n">pn</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">event_level_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;item_category&#39;</span><span class="p">,</span><span class="s1">&#39;item_id&#39;</span><span class="p">,</span><span class="s1">&#39;item_amount&#39;</span><span class="p">,</span><span class="s1">&#39;supplier&#39;</span><span class="p">,</span><span class="s1">&#39;total_price&#39;</span><span class="p">],</span> 
<span class="gp">... </span>                                      <span class="n">activityName_key</span> <span class="o">=</span> <span class="s2">&quot;concept:name&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select a certrain decision point and the corresponding data set </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dp_dataset_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp_dataset</span> <span class="o">=</span> <span class="n">dp_dataset_map</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">data_preprocessing_evaluation</span><span class="p">(</span><span class="n">dp_dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span> <span class="o">=</span> <span class="n">Logistic_Regression_Guard</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div>
  
  <p>For more examples refer to the <a href="https://aarkue.github.io/eXdpn">User Guide</a>.</p>
</blockquote>
</div>


                            </div>
                            <div id="Logistic_Regression_Guard.predict" class="classattr">
                                        <input id="Logistic_Regression_Guard.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">input_instances</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">pm4py</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">petri_net</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">PetriNet</span><span class="o">.</span><span class="n">Transition</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Logistic_Regression_Guard.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Logistic_Regression_Guard.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Logistic_Regression_Guard.predict-102"><a href="#Logistic_Regression_Guard.predict-102"><span class="linenos">102</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_instances</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">PetriNet</span><span class="o">.</span><span class="n">Transition</span><span class="p">]:</span>
</span><span id="Logistic_Regression_Guard.predict-103"><a href="#Logistic_Regression_Guard.predict-103"><span class="linenos">103</span></a>        <span class="sd">&quot;&quot;&quot;Predicts the next transition based on the input instances.</span>
</span><span id="Logistic_Regression_Guard.predict-104"><a href="#Logistic_Regression_Guard.predict-104"><span class="linenos">104</span></a>
</span><span id="Logistic_Regression_Guard.predict-105"><a href="#Logistic_Regression_Guard.predict-105"><span class="linenos">105</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard.predict-106"><a href="#Logistic_Regression_Guard.predict-106"><span class="linenos">106</span></a><span class="sd">            input_instances (DataFrame): Dataset of input instances used to predict the target variable, i.e., the next transition.</span>
</span><span id="Logistic_Regression_Guard.predict-107"><a href="#Logistic_Regression_Guard.predict-107"><span class="linenos">107</span></a>
</span><span id="Logistic_Regression_Guard.predict-108"><a href="#Logistic_Regression_Guard.predict-108"><span class="linenos">108</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard.predict-109"><a href="#Logistic_Regression_Guard.predict-109"><span class="linenos">109</span></a><span class="sd">            List[PetriNet.Transition]: The list of predicted transitions.</span>
</span><span id="Logistic_Regression_Guard.predict-110"><a href="#Logistic_Regression_Guard.predict-110"><span class="linenos">110</span></a>
</span><span id="Logistic_Regression_Guard.predict-111"><a href="#Logistic_Regression_Guard.predict-111"><span class="linenos">111</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard.predict-112"><a href="#Logistic_Regression_Guard.predict-112"><span class="linenos">112</span></a><span class="sd">            </span>
</span><span id="Logistic_Regression_Guard.predict-113"><a href="#Logistic_Regression_Guard.predict-113"><span class="linenos">113</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="Logistic_Regression_Guard.predict-114"><a href="#Logistic_Regression_Guard.predict-114"><span class="linenos">114</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="Logistic_Regression_Guard.predict-115"><a href="#Logistic_Regression_Guard.predict-115"><span class="linenos">115</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="Logistic_Regression_Guard.predict-116"><a href="#Logistic_Regression_Guard.predict-116"><span class="linenos">116</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard.predict-117"><a href="#Logistic_Regression_Guard.predict-117"><span class="linenos">117</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="Logistic_Regression_Guard.predict-118"><a href="#Logistic_Regression_Guard.predict-118"><span class="linenos">118</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="Logistic_Regression_Guard.predict-119"><a href="#Logistic_Regression_Guard.predict-119"><span class="linenos">119</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="Logistic_Regression_Guard.predict-120"><a href="#Logistic_Regression_Guard.predict-120"><span class="linenos">120</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="Logistic_Regression_Guard.predict-121"><a href="#Logistic_Regression_Guard.predict-121"><span class="linenos">121</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="Logistic_Regression_Guard.predict-122"><a href="#Logistic_Regression_Guard.predict-122"><span class="linenos">122</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="Logistic_Regression_Guard.predict-123"><a href="#Logistic_Regression_Guard.predict-123"><span class="linenos">123</span></a><span class="sd">            &gt;&gt;&gt; # select a certrain decision point and the corresponding data set </span>
</span><span id="Logistic_Regression_Guard.predict-124"><a href="#Logistic_Regression_Guard.predict-124"><span class="linenos">124</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="Logistic_Regression_Guard.predict-125"><a href="#Logistic_Regression_Guard.predict-125"><span class="linenos">125</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="Logistic_Regression_Guard.predict-126"><a href="#Logistic_Regression_Guard.predict-126"><span class="linenos">126</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="Logistic_Regression_Guard.predict-127"><a href="#Logistic_Regression_Guard.predict-127"><span class="linenos">127</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard.predict-128"><a href="#Logistic_Regression_Guard.predict-128"><span class="linenos">128</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="Logistic_Regression_Guard.predict-129"><a href="#Logistic_Regression_Guard.predict-129"><span class="linenos">129</span></a><span class="sd">            &gt;&gt;&gt; y_prediction = guard.predict(X_test)</span>
</span><span id="Logistic_Regression_Guard.predict-130"><a href="#Logistic_Regression_Guard.predict-130"><span class="linenos">130</span></a>
</span><span id="Logistic_Regression_Guard.predict-131"><a href="#Logistic_Regression_Guard.predict-131"><span class="linenos">131</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard.predict-132"><a href="#Logistic_Regression_Guard.predict-132"><span class="linenos">132</span></a>
</span><span id="Logistic_Regression_Guard.predict-133"><a href="#Logistic_Regression_Guard.predict-133"><span class="linenos">133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard.predict-134"><a href="#Logistic_Regression_Guard.predict-134"><span class="linenos">134</span></a>        <span class="c1"># scale numerical attributes</span>
</span><span id="Logistic_Regression_Guard.predict-135"><a href="#Logistic_Regression_Guard.predict-135"><span class="linenos">135</span></a>        <span class="n">input_instances</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span>
</span><span id="Logistic_Regression_Guard.predict-136"><a href="#Logistic_Regression_Guard.predict-136"><span class="linenos">136</span></a>            <span class="n">input_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.predict-137"><a href="#Logistic_Regression_Guard.predict-137"><span class="linenos">137</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard.predict-138"><a href="#Logistic_Regression_Guard.predict-138"><span class="linenos">138</span></a>        <span class="n">input_instances</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">input_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.predict-139"><a href="#Logistic_Regression_Guard.predict-139"><span class="linenos">139</span></a>
</span><span id="Logistic_Regression_Guard.predict-140"><a href="#Logistic_Regression_Guard.predict-140"><span class="linenos">140</span></a>        <span class="n">predicted_transition_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_instances</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.predict-141"><a href="#Logistic_Regression_Guard.predict-141"><span class="linenos">141</span></a>        <span class="c1"># ty stackoverflow</span>
</span><span id="Logistic_Regression_Guard.predict-142"><a href="#Logistic_Regression_Guard.predict-142"><span class="linenos">142</span></a>        <span class="c1"># finds the key (transition) where the value (transition integer / id) corresponds to the predicted integer / id</span>
</span><span id="Logistic_Regression_Guard.predict-143"><a href="#Logistic_Regression_Guard.predict-143"><span class="linenos">143</span></a>        <span class="c1"># for all predicted integers</span>
</span><span id="Logistic_Regression_Guard.predict-144"><a href="#Logistic_Regression_Guard.predict-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">trans</span> <span class="k">for</span> <span class="n">trans</span><span class="p">,</span> <span class="n">trans_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">trans_id</span> <span class="o">==</span> <span class="n">pred_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">pred_id</span> <span class="ow">in</span> <span class="n">predicted_transition_ids</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Predicts the next transition based on the input instances.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>input_instances (DataFrame):</strong>  Dataset of input instances used to predict the target variable, i.e., the next transition.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>List[PetriNet.Transition]: The list of predicted transitions.</p>
</blockquote>

<h6 id="examples">Examples</h6>

<blockquote>
  <div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../util.html">exdpn.util</a></span> <span class="kn">import</span> <span class="n">import_log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../petri_net.html">exdpn.petri_net</a></span> <span class="kn">import</span> <span class="n">get_petri_net</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../guard_datasets.html">exdpn.guard_datasets</a></span> <span class="kn">import</span> <span class="n">extract_all_datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../guards.html">exdpn.guards</a></span> <span class="kn">import</span> <span class="n">Logistic_Regression_Guard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../data_preprocessing.html">exdpn.data_preprocessing</a></span> <span class="kn">import</span> <span class="n">data_preprocessing_evaluation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event_log</span> <span class="o">=</span> <span class="n">import_log</span><span class="p">(</span><span class="s1">&#39;./datasets/p2p_base.xes&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pn</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">fm</span> <span class="o">=</span> <span class="n">get_petri_net</span><span class="p">(</span><span class="n">event_log</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp_dataset_map</span> <span class="o">=</span> <span class="n">extract_all_datasets</span><span class="p">(</span><span class="n">event_log</span><span class="p">,</span> <span class="n">pn</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">event_level_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;item_category&#39;</span><span class="p">,</span><span class="s1">&#39;item_id&#39;</span><span class="p">,</span><span class="s1">&#39;item_amount&#39;</span><span class="p">,</span><span class="s1">&#39;supplier&#39;</span><span class="p">,</span><span class="s1">&#39;total_price&#39;</span><span class="p">],</span> 
<span class="gp">... </span>                                      <span class="n">activityName_key</span> <span class="o">=</span> <span class="s2">&quot;concept:name&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select a certrain decision point and the corresponding data set </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dp_dataset_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp_dataset</span> <span class="o">=</span> <span class="n">dp_dataset_map</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">data_preprocessing_evaluation</span><span class="p">(</span><span class="n">dp_dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span> <span class="o">=</span> <span class="n">Logistic_Regression_Guard</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_prediction</span> <span class="o">=</span> <span class="n">guard</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
  
  <p>For more examples refer to the <a href="https://aarkue.github.io/eXdpn">User Guide</a>.</p>
</blockquote>
</div>


                            </div>
                            <div id="Logistic_Regression_Guard.is_explainable" class="classattr">
                                        <input id="Logistic_Regression_Guard.is_explainable-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_explainable</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Logistic_Regression_Guard.is_explainable-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Logistic_Regression_Guard.is_explainable"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Logistic_Regression_Guard.is_explainable-146"><a href="#Logistic_Regression_Guard.is_explainable-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">is_explainable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.is_explainable-147"><a href="#Logistic_Regression_Guard.is_explainable-147"><span class="linenos">147</span></a>        <span class="sd">&quot;&quot;&quot;Returns whether or not this guard is explainable.</span>
</span><span id="Logistic_Regression_Guard.is_explainable-148"><a href="#Logistic_Regression_Guard.is_explainable-148"><span class="linenos">148</span></a>
</span><span id="Logistic_Regression_Guard.is_explainable-149"><a href="#Logistic_Regression_Guard.is_explainable-149"><span class="linenos">149</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard.is_explainable-150"><a href="#Logistic_Regression_Guard.is_explainable-150"><span class="linenos">150</span></a><span class="sd">            bool: Whether or not the guard is explainable.</span>
</span><span id="Logistic_Regression_Guard.is_explainable-151"><a href="#Logistic_Regression_Guard.is_explainable-151"><span class="linenos">151</span></a>
</span><span id="Logistic_Regression_Guard.is_explainable-152"><a href="#Logistic_Regression_Guard.is_explainable-152"><span class="linenos">152</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard.is_explainable-153"><a href="#Logistic_Regression_Guard.is_explainable-153"><span class="linenos">153</span></a><span class="sd">            </span>
</span><span id="Logistic_Regression_Guard.is_explainable-154"><a href="#Logistic_Regression_Guard.is_explainable-154"><span class="linenos">154</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard.is_explainable-155"><a href="#Logistic_Regression_Guard.is_explainable-155"><span class="linenos">155</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard.is_explainable-156"><a href="#Logistic_Regression_Guard.is_explainable-156"><span class="linenos">156</span></a><span class="sd">            &gt;&gt;&gt; guard.is_explainable()</span>
</span><span id="Logistic_Regression_Guard.is_explainable-157"><a href="#Logistic_Regression_Guard.is_explainable-157"><span class="linenos">157</span></a><span class="sd">            True</span>
</span><span id="Logistic_Regression_Guard.is_explainable-158"><a href="#Logistic_Regression_Guard.is_explainable-158"><span class="linenos">158</span></a>
</span><span id="Logistic_Regression_Guard.is_explainable-159"><a href="#Logistic_Regression_Guard.is_explainable-159"><span class="linenos">159</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard.is_explainable-160"><a href="#Logistic_Regression_Guard.is_explainable-160"><span class="linenos">160</span></a>
</span><span id="Logistic_Regression_Guard.is_explainable-161"><a href="#Logistic_Regression_Guard.is_explainable-161"><span class="linenos">161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard.is_explainable-162"><a href="#Logistic_Regression_Guard.is_explainable-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Returns whether or not this guard is explainable.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>bool: Whether or not the guard is explainable.</p>
</blockquote>

<h6 id="examples">Examples</h6>

<blockquote>
  <div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../guards.html">exdpn.guards</a></span> <span class="kn">import</span> <span class="n">Logistic_Regression_Guard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span> <span class="o">=</span> <span class="n">Logistic_Regression_Guard</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span><span class="o">.</span><span class="n">is_explainable</span><span class="p">()</span>
<span class="go">True</span>
</code></pre></div>
  
  <p>For more examples refer to the <a href="https://aarkue.github.io/eXdpn">User Guide</a>.</p>
</blockquote>
</div>


                            </div>
                            <div id="Logistic_Regression_Guard.get_explainable_representation" class="classattr">
                                        <input id="Logistic_Regression_Guard.get_explainable_representation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_explainable_representation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span>:</span></span>

                <label class="view-source-button" for="Logistic_Regression_Guard.get_explainable_representation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Logistic_Regression_Guard.get_explainable_representation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Logistic_Regression_Guard.get_explainable_representation-164"><a href="#Logistic_Regression_Guard.get_explainable_representation-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">get_explainable_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-165"><a href="#Logistic_Regression_Guard.get_explainable_representation-165"><span class="linenos">165</span></a>        <span class="sd">&quot;&quot;&quot;Returns an explainable representation of the logistic regression guard, a Matplotlib plot using SHAP.</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-166"><a href="#Logistic_Regression_Guard.get_explainable_representation-166"><span class="linenos">166</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-167"><a href="#Logistic_Regression_Guard.get_explainable_representation-167"><span class="linenos">167</span></a><span class="sd">            data (DataFrame): Dataset of input instances used to construct an explainable representation.</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-168"><a href="#Logistic_Regression_Guard.get_explainable_representation-168"><span class="linenos">168</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-169"><a href="#Logistic_Regression_Guard.get_explainable_representation-169"><span class="linenos">169</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-170"><a href="#Logistic_Regression_Guard.get_explainable_representation-170"><span class="linenos">170</span></a><span class="sd">            Figure: Matplotlib Figure of the trained logistic regression model.</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-171"><a href="#Logistic_Regression_Guard.get_explainable_representation-171"><span class="linenos">171</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-172"><a href="#Logistic_Regression_Guard.get_explainable_representation-172"><span class="linenos">172</span></a><span class="sd">        Raises:</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-173"><a href="#Logistic_Regression_Guard.get_explainable_representation-173"><span class="linenos">173</span></a><span class="sd">            Exception: If guard has no explainable representation.</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-174"><a href="#Logistic_Regression_Guard.get_explainable_representation-174"><span class="linenos">174</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-175"><a href="#Logistic_Regression_Guard.get_explainable_representation-175"><span class="linenos">175</span></a><span class="sd">        Examples:</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-176"><a href="#Logistic_Regression_Guard.get_explainable_representation-176"><span class="linenos">176</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-177"><a href="#Logistic_Regression_Guard.get_explainable_representation-177"><span class="linenos">177</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.util import import_log</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-178"><a href="#Logistic_Regression_Guard.get_explainable_representation-178"><span class="linenos">178</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.petri_net import get_petri_net</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-179"><a href="#Logistic_Regression_Guard.get_explainable_representation-179"><span class="linenos">179</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guard_datasets import extract_all_datasets</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-180"><a href="#Logistic_Regression_Guard.get_explainable_representation-180"><span class="linenos">180</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.guards import Logistic_Regression_Guard</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-181"><a href="#Logistic_Regression_Guard.get_explainable_representation-181"><span class="linenos">181</span></a><span class="sd">            &gt;&gt;&gt; from exdpn.data_preprocessing import data_preprocessing_evaluation</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-182"><a href="#Logistic_Regression_Guard.get_explainable_representation-182"><span class="linenos">182</span></a><span class="sd">            &gt;&gt;&gt; event_log = import_log(&#39;./datasets/p2p_base.xes&#39;)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-183"><a href="#Logistic_Regression_Guard.get_explainable_representation-183"><span class="linenos">183</span></a><span class="sd">            &gt;&gt;&gt; pn, im, fm = get_petri_net(event_log)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-184"><a href="#Logistic_Regression_Guard.get_explainable_representation-184"><span class="linenos">184</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset_map = extract_all_datasets(event_log, pn, im, fm,</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-185"><a href="#Logistic_Regression_Guard.get_explainable_representation-185"><span class="linenos">185</span></a><span class="sd">            ...                                       event_level_attributes = [&#39;item_category&#39;,&#39;item_id&#39;,&#39;item_amount&#39;,&#39;supplier&#39;,&#39;total_price&#39;], </span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-186"><a href="#Logistic_Regression_Guard.get_explainable_representation-186"><span class="linenos">186</span></a><span class="sd">            ...                                       activityName_key = &quot;concept:name&quot;)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-187"><a href="#Logistic_Regression_Guard.get_explainable_representation-187"><span class="linenos">187</span></a><span class="sd">            &gt;&gt;&gt; # select a certain decision point and the corresponding data set </span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-188"><a href="#Logistic_Regression_Guard.get_explainable_representation-188"><span class="linenos">188</span></a><span class="sd">            &gt;&gt;&gt; dp = list(dp_dataset_map.keys())[0]</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-189"><a href="#Logistic_Regression_Guard.get_explainable_representation-189"><span class="linenos">189</span></a><span class="sd">            &gt;&gt;&gt; dp_dataset = dp_dataset_map[dp]</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-190"><a href="#Logistic_Regression_Guard.get_explainable_representation-190"><span class="linenos">190</span></a><span class="sd">            &gt;&gt;&gt; X_train, X_test, y_train, y_test = data_preprocessing_evaluation(dp_dataset)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-191"><a href="#Logistic_Regression_Guard.get_explainable_representation-191"><span class="linenos">191</span></a><span class="sd">            &gt;&gt;&gt; guard = Logistic_Regression_Guard()</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-192"><a href="#Logistic_Regression_Guard.get_explainable_representation-192"><span class="linenos">192</span></a><span class="sd">            &gt;&gt;&gt; guard.train(X_train, y_train)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-193"><a href="#Logistic_Regression_Guard.get_explainable_representation-193"><span class="linenos">193</span></a><span class="sd">            &gt;&gt;&gt; y_prediction = guard.predict(X_test)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-194"><a href="#Logistic_Regression_Guard.get_explainable_representation-194"><span class="linenos">194</span></a><span class="sd">            &gt;&gt;&gt; # return figure of explainable representation</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-195"><a href="#Logistic_Regression_Guard.get_explainable_representation-195"><span class="linenos">195</span></a><span class="sd">            &gt;&gt;&gt; fig = guard.get_explainable_representation(X_test) # results may deviate </span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-196"><a href="#Logistic_Regression_Guard.get_explainable_representation-196"><span class="linenos">196</span></a><span class="sd">            </span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-197"><a href="#Logistic_Regression_Guard.get_explainable_representation-197"><span class="linenos">197</span></a><span class="sd">            &lt;img src=&quot;../../images/lr-example-representation.svg&quot; alt=&quot;Example explainable representation of a logistic regression guard&quot; style=&quot;max-height: 350px;&quot;/&gt;</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-198"><a href="#Logistic_Regression_Guard.get_explainable_representation-198"><span class="linenos">198</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-199"><a href="#Logistic_Regression_Guard.get_explainable_representation-199"><span class="linenos">199</span></a><span class="sd">            .. include:: ../../docs/_templates/md/example-end.md</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-200"><a href="#Logistic_Regression_Guard.get_explainable_representation-200"><span class="linenos">200</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-201"><a href="#Logistic_Regression_Guard.get_explainable_representation-201"><span class="linenos">201</span></a><span class="sd">        Note: </span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-202"><a href="#Logistic_Regression_Guard.get_explainable_representation-202"><span class="linenos">202</span></a><span class="sd">            For an example of the explainable representations of all machine learning techniques please check [Data Petri Net Example](https://github.com/aarkue/eXdpn/blob/main/docs/dpn_example.ipynb).</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-203"><a href="#Logistic_Regression_Guard.get_explainable_representation-203"><span class="linenos">203</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-204"><a href="#Logistic_Regression_Guard.get_explainable_representation-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-205"><a href="#Logistic_Regression_Guard.get_explainable_representation-205"><span class="linenos">205</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_explainable</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-206"><a href="#Logistic_Regression_Guard.get_explainable_representation-206"><span class="linenos">206</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-207"><a href="#Logistic_Regression_Guard.get_explainable_representation-207"><span class="linenos">207</span></a>                <span class="s2">&quot;Guard is not explainable and therefore has no explainable representation&quot;</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-208"><a href="#Logistic_Regression_Guard.get_explainable_representation-208"><span class="linenos">208</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-209"><a href="#Logistic_Regression_Guard.get_explainable_representation-209"><span class="linenos">209</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-210"><a href="#Logistic_Regression_Guard.get_explainable_representation-210"><span class="linenos">210</span></a>                   <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-211"><a href="#Logistic_Regression_Guard.get_explainable_representation-211"><span class="linenos">211</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-212"><a href="#Logistic_Regression_Guard.get_explainable_representation-212"><span class="linenos">212</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-213"><a href="#Logistic_Regression_Guard.get_explainable_representation-213"><span class="linenos">213</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-214"><a href="#Logistic_Regression_Guard.get_explainable_representation-214"><span class="linenos">214</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-215"><a href="#Logistic_Regression_Guard.get_explainable_representation-215"><span class="linenos">215</span></a>        
</span><span id="Logistic_Regression_Guard.get_explainable_representation-216"><a href="#Logistic_Regression_Guard.get_explainable_representation-216"><span class="linenos">216</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">LinearExplainer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-217"><a href="#Logistic_Regression_Guard.get_explainable_representation-217"><span class="linenos">217</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-218"><a href="#Logistic_Regression_Guard.get_explainable_representation-218"><span class="linenos">218</span></a>        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-219"><a href="#Logistic_Regression_Guard.get_explainable_representation-219"><span class="linenos">219</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-220"><a href="#Logistic_Regression_Guard.get_explainable_representation-220"><span class="linenos">220</span></a>        <span class="c1"># Docs for this summary plot: https://shap-lrjball.readthedocs.io/en/latest/generated/shap.summary_plot.html</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-221"><a href="#Logistic_Regression_Guard.get_explainable_representation-221"><span class="linenos">221</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-222"><a href="#Logistic_Regression_Guard.get_explainable_representation-222"><span class="linenos">222</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-223"><a href="#Logistic_Regression_Guard.get_explainable_representation-223"><span class="linenos">223</span></a>                            <span class="n">data</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-224"><a href="#Logistic_Regression_Guard.get_explainable_representation-224"><span class="linenos">224</span></a>                            <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-225"><a href="#Logistic_Regression_Guard.get_explainable_representation-225"><span class="linenos">225</span></a>                            <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-226"><a href="#Logistic_Regression_Guard.get_explainable_representation-226"><span class="linenos">226</span></a>                            <span class="n">class_names</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-227"><a href="#Logistic_Regression_Guard.get_explainable_representation-227"><span class="linenos">227</span></a>                            <span class="n">class_inds</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)))</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-228"><a href="#Logistic_Regression_Guard.get_explainable_representation-228"><span class="linenos">228</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Feature Impact on Model Prediction&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-229"><a href="#Logistic_Regression_Guard.get_explainable_representation-229"><span class="linenos">229</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Feature Attributes&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-230"><a href="#Logistic_Regression_Guard.get_explainable_representation-230"><span class="linenos">230</span></a>
</span><span id="Logistic_Regression_Guard.get_explainable_representation-231"><a href="#Logistic_Regression_Guard.get_explainable_representation-231"><span class="linenos">231</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span></pre></div>


            <div class="docstring"><p>Returns an explainable representation of the logistic regression guard, a Matplotlib plot using SHAP.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>data (DataFrame):</strong>  Dataset of input instances used to construct an explainable representation.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Figure: Matplotlib Figure of the trained logistic regression model.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>Exception:</strong>  If guard has no explainable representation.</li>
</ul>

<h6 id="examples">Examples</h6>

<blockquote>
  <div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../util.html">exdpn.util</a></span> <span class="kn">import</span> <span class="n">import_log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../petri_net.html">exdpn.petri_net</a></span> <span class="kn">import</span> <span class="n">get_petri_net</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../guard_datasets.html">exdpn.guard_datasets</a></span> <span class="kn">import</span> <span class="n">extract_all_datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../guards.html">exdpn.guards</a></span> <span class="kn">import</span> <span class="n">Logistic_Regression_Guard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="../data_preprocessing.html">exdpn.data_preprocessing</a></span> <span class="kn">import</span> <span class="n">data_preprocessing_evaluation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event_log</span> <span class="o">=</span> <span class="n">import_log</span><span class="p">(</span><span class="s1">&#39;./datasets/p2p_base.xes&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pn</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">fm</span> <span class="o">=</span> <span class="n">get_petri_net</span><span class="p">(</span><span class="n">event_log</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp_dataset_map</span> <span class="o">=</span> <span class="n">extract_all_datasets</span><span class="p">(</span><span class="n">event_log</span><span class="p">,</span> <span class="n">pn</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">event_level_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;item_category&#39;</span><span class="p">,</span><span class="s1">&#39;item_id&#39;</span><span class="p">,</span><span class="s1">&#39;item_amount&#39;</span><span class="p">,</span><span class="s1">&#39;supplier&#39;</span><span class="p">,</span><span class="s1">&#39;total_price&#39;</span><span class="p">],</span> 
<span class="gp">... </span>                                      <span class="n">activityName_key</span> <span class="o">=</span> <span class="s2">&quot;concept:name&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select a certain decision point and the corresponding data set </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dp_dataset_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp_dataset</span> <span class="o">=</span> <span class="n">dp_dataset_map</span><span class="p">[</span><span class="n">dp</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">data_preprocessing_evaluation</span><span class="p">(</span><span class="n">dp_dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span> <span class="o">=</span> <span class="n">Logistic_Regression_Guard</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guard</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_prediction</span> <span class="o">=</span> <span class="n">guard</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># return figure of explainable representation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">guard</span><span class="o">.</span><span class="n">get_explainable_representation</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> <span class="c1"># results may deviate </span>
</code></pre></div>
  
  <p><img src="../../images/lr-example-representation.svg" alt="Example explainable representation of a logistic regression guard" style="max-height: 350px;"/></p>
  
  <p>For more examples refer to the <a href="https://aarkue.github.io/eXdpn">User Guide</a>.</p>
</blockquote>

<p>Note: 
    For an example of the explainable representations of all machine learning techniques please check <a href="https://github.com/aarkue/eXdpn/blob/main/docs/dpn_example.ipynb">Data Petri Net Example</a>.</p>
</div>


                            </div>
                            <div id="Logistic_Regression_Guard.get_global_explanations" class="classattr">
                                        <input id="Logistic_Regression_Guard.get_global_explanations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_global_explanations</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">base_sample</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Logistic_Regression_Guard.get_global_explanations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Logistic_Regression_Guard.get_global_explanations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Logistic_Regression_Guard.get_global_explanations-233"><a href="#Logistic_Regression_Guard.get_global_explanations-233"><span class="linenos">233</span></a>    <span class="k">def</span> <span class="nf">get_global_explanations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_sample</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Union</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-234"><a href="#Logistic_Regression_Guard.get_global_explanations-234"><span class="linenos">234</span></a>        <span class="sd">&quot;&quot;&quot;Get a global explainable representation for the concrete machine learning classifier.</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-235"><a href="#Logistic_Regression_Guard.get_global_explanations-235"><span class="linenos">235</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-236"><a href="#Logistic_Regression_Guard.get_global_explanations-236"><span class="linenos">236</span></a><span class="sd">            base_sample (DataFrame): A small (10-30) sample of the population for this decision point; Used for calculation of shap values.</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-237"><a href="#Logistic_Regression_Guard.get_global_explanations-237"><span class="linenos">237</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-238"><a href="#Logistic_Regression_Guard.get_global_explanations-238"><span class="linenos">238</span></a><span class="sd">            Dict[str,Figure]: A dictionary containing the global explainable representations. Containing the following entries:</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-239"><a href="#Logistic_Regression_Guard.get_global_explanations-239"><span class="linenos">239</span></a><span class="sd">            - &quot;Bar plot (Summary)&quot;</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-240"><a href="#Logistic_Regression_Guard.get_global_explanations-240"><span class="linenos">240</span></a><span class="sd">            - &quot;Beeswarm plot for `X`&quot; (for all output labels X)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-241"><a href="#Logistic_Regression_Guard.get_global_explanations-241"><span class="linenos">241</span></a><span class="sd">            - &quot;Force plot for `X`&quot; (for all output labels X)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-242"><a href="#Logistic_Regression_Guard.get_global_explanations-242"><span class="linenos">242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-243"><a href="#Logistic_Regression_Guard.get_global_explanations-243"><span class="linenos">243</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-244"><a href="#Logistic_Regression_Guard.get_global_explanations-244"><span class="linenos">244</span></a>        <span class="c1"># one hot encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-245"><a href="#Logistic_Regression_Guard.get_global_explanations-245"><span class="linenos">245</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-246"><a href="#Logistic_Regression_Guard.get_global_explanations-246"><span class="linenos">246</span></a>        <span class="n">unscaled_base_sample</span> <span class="o">=</span> <span class="n">processed_base_sample</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-247"><a href="#Logistic_Regression_Guard.get_global_explanations-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-248"><a href="#Logistic_Regression_Guard.get_global_explanations-248"><span class="linenos">248</span></a>            <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">unscaled_base_sample</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-249"><a href="#Logistic_Regression_Guard.get_global_explanations-249"><span class="linenos">249</span></a>                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">():</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-250"><a href="#Logistic_Regression_Guard.get_global_explanations-250"><span class="linenos">250</span></a>                    <span class="n">row</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_sample</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-251"><a href="#Logistic_Regression_Guard.get_global_explanations-251"><span class="linenos">251</span></a>        <span class="k">def</span> <span class="nf">shap_predict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-252"><a href="#Logistic_Regression_Guard.get_global_explanations-252"><span class="linenos">252</span></a>            <span class="n">data_asframe</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-253"><a href="#Logistic_Regression_Guard.get_global_explanations-253"><span class="linenos">253</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">data_asframe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-254"><a href="#Logistic_Regression_Guard.get_global_explanations-254"><span class="linenos">254</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-255"><a href="#Logistic_Regression_Guard.get_global_explanations-255"><span class="linenos">255</span></a>
</span><span id="Logistic_Regression_Guard.get_global_explanations-256"><a href="#Logistic_Regression_Guard.get_global_explanations-256"><span class="linenos">256</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">shap_predict</span><span class="p">,</span> <span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-257"><a href="#Logistic_Regression_Guard.get_global_explanations-257"><span class="linenos">257</span></a>        <span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">l1_reg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;num_features(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-258"><a href="#Logistic_Regression_Guard.get_global_explanations-258"><span class="linenos">258</span></a>        <span class="c1"># shap_values = explainer.shap_values(processed_base_sample)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-259"><a href="#Logistic_Regression_Guard.get_global_explanations-259"><span class="linenos">259</span></a>        <span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-260"><a href="#Logistic_Regression_Guard.get_global_explanations-260"><span class="linenos">260</span></a>                        <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-261"><a href="#Logistic_Regression_Guard.get_global_explanations-261"><span class="linenos">261</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-262"><a href="#Logistic_Regression_Guard.get_global_explanations-262"><span class="linenos">262</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-263"><a href="#Logistic_Regression_Guard.get_global_explanations-263"><span class="linenos">263</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-264"><a href="#Logistic_Regression_Guard.get_global_explanations-264"><span class="linenos">264</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span> <span class="n">unscaled_base_sample</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span> <span class="n">use_log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">max_display</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-265"><a href="#Logistic_Regression_Guard.get_global_explanations-265"><span class="linenos">265</span></a>        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Bar plot (Summary)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="p">;</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-266"><a href="#Logistic_Regression_Guard.get_global_explanations-266"><span class="linenos">266</span></a>
</span><span id="Logistic_Regression_Guard.get_global_explanations-267"><a href="#Logistic_Regression_Guard.get_global_explanations-267"><span class="linenos">267</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_names</span><span class="p">)):</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-268"><a href="#Logistic_Regression_Guard.get_global_explanations-268"><span class="linenos">268</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-269"><a href="#Logistic_Regression_Guard.get_global_explanations-269"><span class="linenos">269</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-270"><a href="#Logistic_Regression_Guard.get_global_explanations-270"><span class="linenos">270</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">beeswarm</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">Explanation</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">shap_values</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
</span><span id="Logistic_Regression_Guard.get_global_explanations-271"><a href="#Logistic_Regression_Guard.get_global_explanations-271"><span class="linenos">271</span></a>                                                            <span class="n">base_values</span><span class="o">=</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">unscaled_base_sample</span><span class="p">,</span>  
</span><span id="Logistic_Regression_Guard.get_global_explanations-272"><a href="#Logistic_Regression_Guard.get_global_explanations-272"><span class="linenos">272</span></a>                                                    <span class="n">feature_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-273"><a href="#Logistic_Regression_Guard.get_global_explanations-273"><span class="linenos">273</span></a>                                                    <span class="n">order</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)))</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-274"><a href="#Logistic_Regression_Guard.get_global_explanations-274"><span class="linenos">274</span></a>            <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-275"><a href="#Logistic_Regression_Guard.get_global_explanations-275"><span class="linenos">275</span></a>            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-276"><a href="#Logistic_Regression_Guard.get_global_explanations-276"><span class="linenos">276</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Beeswarm plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-277"><a href="#Logistic_Regression_Guard.get_global_explanations-277"><span class="linenos">277</span></a>
</span><span id="Logistic_Regression_Guard.get_global_explanations-278"><a href="#Logistic_Regression_Guard.get_global_explanations-278"><span class="linenos">278</span></a>            <span class="n">force_plot</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">force_plot</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[[</span><span class="n">key</span><span class="p">]],</span><span class="n">shap_values</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">features</span><span class="o">=</span><span class="n">unscaled_base_sample</span><span class="p">,</span> <span class="n">out_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-279"><a href="#Logistic_Regression_Guard.get_global_explanations-279"><span class="linenos">279</span></a>            <span class="n">html_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-280"><a href="#Logistic_Regression_Guard.get_global_explanations-280"><span class="linenos">280</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">save_html</span><span class="p">(</span><span class="n">html_data</span><span class="p">,</span><span class="n">force_plot</span><span class="p">,</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-281"><a href="#Logistic_Regression_Guard.get_global_explanations-281"><span class="linenos">281</span></a>            <span class="n">html_data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># rewind the data</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-282"><a href="#Logistic_Regression_Guard.get_global_explanations-282"><span class="linenos">282</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Force plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">html_data</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_global_explanations-283"><a href="#Logistic_Regression_Guard.get_global_explanations-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Get a global explainable representation for the concrete machine learning classifier.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>base_sample (DataFrame):</strong>  A small (10-30) sample of the population for this decision point; Used for calculation of shap values.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Dict[str,Figure]: A dictionary containing the global explainable representations. Containing the following entries:</p>
  
  <ul>
  <li>"Bar plot (Summary)"</li>
  <li>"Beeswarm plot for <code>X</code>" (for all output labels X)</li>
  <li>"Force plot for <code>X</code>" (for all output labels X)</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div id="Logistic_Regression_Guard.get_local_explanations" class="classattr">
                                        <input id="Logistic_Regression_Guard.get_local_explanations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_local_explanations</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">local_data</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">base_sample</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Logistic_Regression_Guard.get_local_explanations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Logistic_Regression_Guard.get_local_explanations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Logistic_Regression_Guard.get_local_explanations-286"><a href="#Logistic_Regression_Guard.get_local_explanations-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="nf">get_local_explanations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">local_data</span><span class="p">:</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">base_sample</span><span class="p">:</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Figure</span><span class="p">]:</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-287"><a href="#Logistic_Regression_Guard.get_local_explanations-287"><span class="linenos">287</span></a>        <span class="sd">&quot;&quot;&quot;Get explainable representations for a single decision situation. </span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-288"><a href="#Logistic_Regression_Guard.get_local_explanations-288"><span class="linenos">288</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-289"><a href="#Logistic_Regression_Guard.get_local_explanations-289"><span class="linenos">289</span></a><span class="sd">        Args:</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-290"><a href="#Logistic_Regression_Guard.get_local_explanations-290"><span class="linenos">290</span></a><span class="sd">            local_data (DataFrame): A dataframe containing the single decision situation.</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-291"><a href="#Logistic_Regression_Guard.get_local_explanations-291"><span class="linenos">291</span></a><span class="sd">            base_sample (DataFrame): A small (10-30) sample of the population for this decision point; Used for calculation of shap values.</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-292"><a href="#Logistic_Regression_Guard.get_local_explanations-292"><span class="linenos">292</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-293"><a href="#Logistic_Regression_Guard.get_local_explanations-293"><span class="linenos">293</span></a><span class="sd">        Returns:</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-294"><a href="#Logistic_Regression_Guard.get_local_explanations-294"><span class="linenos">294</span></a><span class="sd">            Dict[str,Figure]: A dictionary containing the explainable representations for the single decision situation. Containing the following entries:</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-295"><a href="#Logistic_Regression_Guard.get_local_explanations-295"><span class="linenos">295</span></a><span class="sd">            - &quot;Decision plot (Multioutput)&quot;</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-296"><a href="#Logistic_Regression_Guard.get_local_explanations-296"><span class="linenos">296</span></a><span class="sd">            - &quot;Decision plot for `X`&quot; (for all output labels X)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-297"><a href="#Logistic_Regression_Guard.get_local_explanations-297"><span class="linenos">297</span></a><span class="sd">            - &quot;Force plot for `X`&quot; (for all output labels X)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-298"><a href="#Logistic_Regression_Guard.get_local_explanations-298"><span class="linenos">298</span></a><span class="sd">                </span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-299"><a href="#Logistic_Regression_Guard.get_local_explanations-299"><span class="linenos">299</span></a><span class="sd">        &quot;&quot;&quot;</span>  
</span><span id="Logistic_Regression_Guard.get_local_explanations-300"><a href="#Logistic_Regression_Guard.get_local_explanations-300"><span class="linenos">300</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-301"><a href="#Logistic_Regression_Guard.get_local_explanations-301"><span class="linenos">301</span></a>        <span class="k">assert</span> <span class="n">local_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-302"><a href="#Logistic_Regression_Guard.get_local_explanations-302"><span class="linenos">302</span></a>        <span class="c1"># Pre-process local_data</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-303"><a href="#Logistic_Regression_Guard.get_local_explanations-303"><span class="linenos">303</span></a>        <span class="c1"># Scale data</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-304"><a href="#Logistic_Regression_Guard.get_local_explanations-304"><span class="linenos">304</span></a>        <span class="n">processed_local_data</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">local_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-305"><a href="#Logistic_Regression_Guard.get_local_explanations-305"><span class="linenos">305</span></a>        <span class="c1"># One-Hot Encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-306"><a href="#Logistic_Regression_Guard.get_local_explanations-306"><span class="linenos">306</span></a>        <span class="n">processed_local_data</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-307"><a href="#Logistic_Regression_Guard.get_local_explanations-307"><span class="linenos">307</span></a>        
</span><span id="Logistic_Regression_Guard.get_local_explanations-308"><a href="#Logistic_Regression_Guard.get_local_explanations-308"><span class="linenos">308</span></a>        <span class="c1"># Pre-process base_sample</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-309"><a href="#Logistic_Regression_Guard.get_local_explanations-309"><span class="linenos">309</span></a>        <span class="c1"># Scale data</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-310"><a href="#Logistic_Regression_Guard.get_local_explanations-310"><span class="linenos">310</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_scaling</span><span class="p">(</span><span class="n">base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_columns</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-311"><a href="#Logistic_Regression_Guard.get_local_explanations-311"><span class="linenos">311</span></a>        <span class="c1"># One-Hot Encoding for categorical data</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-312"><a href="#Logistic_Regression_Guard.get_local_explanations-312"><span class="linenos">312</span></a>        <span class="n">processed_base_sample</span> <span class="o">=</span> <span class="n">apply_ohe</span><span class="p">(</span><span class="n">processed_base_sample</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ohe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-313"><a href="#Logistic_Regression_Guard.get_local_explanations-313"><span class="linenos">313</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-314"><a href="#Logistic_Regression_Guard.get_local_explanations-314"><span class="linenos">314</span></a>        <span class="c1"># transitions_labels =  {i: n for n,i in self.transition_int_map.items()}</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-315"><a href="#Logistic_Regression_Guard.get_local_explanations-315"><span class="linenos">315</span></a>        <span class="c1"># target_names = [transitions_labels[i] for i in sorted(transitions_labels.keys())]</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-316"><a href="#Logistic_Regression_Guard.get_local_explanations-316"><span class="linenos">316</span></a>        <span class="n">target_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-317"><a href="#Logistic_Regression_Guard.get_local_explanations-317"><span class="linenos">317</span></a>                   <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;None (</span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_int_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-318"><a href="#Logistic_Regression_Guard.get_local_explanations-318"><span class="linenos">318</span></a>        <span class="k">def</span> <span class="nf">shap_predict</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-319"><a href="#Logistic_Regression_Guard.get_local_explanations-319"><span class="linenos">319</span></a>            <span class="n">data_asframe</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-320"><a href="#Logistic_Regression_Guard.get_local_explanations-320"><span class="linenos">320</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">data_asframe</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-321"><a href="#Logistic_Regression_Guard.get_local_explanations-321"><span class="linenos">321</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-322"><a href="#Logistic_Regression_Guard.get_local_explanations-322"><span class="linenos">322</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-323"><a href="#Logistic_Regression_Guard.get_local_explanations-323"><span class="linenos">323</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">shap_predict</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-324"><a href="#Logistic_Regression_Guard.get_local_explanations-324"><span class="linenos">324</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-325"><a href="#Logistic_Regression_Guard.get_local_explanations-325"><span class="linenos">325</span></a>        <span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-326"><a href="#Logistic_Regression_Guard.get_local_explanations-326"><span class="linenos">326</span></a>            <span class="n">shap_predict</span><span class="p">,</span> <span class="n">processed_base_sample</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-327"><a href="#Logistic_Regression_Guard.get_local_explanations-327"><span class="linenos">327</span></a>        <span class="n">single_shap</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">processed_local_data</span><span class="p">,</span> <span class="n">nsamples</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">l1_reg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;num_features(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-328"><a href="#Logistic_Regression_Guard.get_local_explanations-328"><span class="linenos">328</span></a>        
</span><span id="Logistic_Regression_Guard.get_local_explanations-329"><a href="#Logistic_Regression_Guard.get_local_explanations-329"><span class="linenos">329</span></a>        <span class="n">unscaled_local_data</span> <span class="o">=</span> <span class="n">processed_local_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-330"><a href="#Logistic_Regression_Guard.get_local_explanations-330"><span class="linenos">330</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-331"><a href="#Logistic_Regression_Guard.get_local_explanations-331"><span class="linenos">331</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">():</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-332"><a href="#Logistic_Regression_Guard.get_local_explanations-332"><span class="linenos">332</span></a>                <span class="n">unscaled_local_data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">local_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-333"><a href="#Logistic_Regression_Guard.get_local_explanations-333"><span class="linenos">333</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-334"><a href="#Logistic_Regression_Guard.get_local_explanations-334"><span class="linenos">334</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-335"><a href="#Logistic_Regression_Guard.get_local_explanations-335"><span class="linenos">335</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-336"><a href="#Logistic_Regression_Guard.get_local_explanations-336"><span class="linenos">336</span></a>        <span class="n">shap</span><span class="o">.</span><span class="n">multioutput_decision_plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">),</span><span class="n">single_shap</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-337"><a href="#Logistic_Regression_Guard.get_local_explanations-337"><span class="linenos">337</span></a>        <span class="n">features</span><span class="o">=</span><span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">row_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-338"><a href="#Logistic_Regression_Guard.get_local_explanations-338"><span class="linenos">338</span></a>        <span class="n">highlight</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span> <span class="n">legend_labels</span><span class="o">=</span><span class="n">target_names</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-339"><a href="#Logistic_Regression_Guard.get_local_explanations-339"><span class="linenos">339</span></a>        <span class="n">legend_location</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> <span class="n">feature_display_range</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-340"><a href="#Logistic_Regression_Guard.get_local_explanations-340"><span class="linenos">340</span></a>        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Decision plot (Multioutput)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-341"><a href="#Logistic_Regression_Guard.get_local_explanations-341"><span class="linenos">341</span></a>        
</span><span id="Logistic_Regression_Guard.get_local_explanations-342"><a href="#Logistic_Regression_Guard.get_local_explanations-342"><span class="linenos">342</span></a>        
</span><span id="Logistic_Regression_Guard.get_local_explanations-343"><a href="#Logistic_Regression_Guard.get_local_explanations-343"><span class="linenos">343</span></a>        <span class="n">winner_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-344"><a href="#Logistic_Regression_Guard.get_local_explanations-344"><span class="linenos">344</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">single_shap</span><span class="p">)):</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-345"><a href="#Logistic_Regression_Guard.get_local_explanations-345"><span class="linenos">345</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-346"><a href="#Logistic_Regression_Guard.get_local_explanations-346"><span class="linenos">346</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">decision_plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">)[</span><span class="n">key</span><span class="p">],</span><span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">features</span><span class="o">=</span><span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="s1">&#39;logit&#39;</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-347"><a href="#Logistic_Regression_Guard.get_local_explanations-347"><span class="linenos">347</span></a>            <span class="n">legend_labels</span><span class="o">=</span><span class="p">[</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]],</span> <span class="n">feature_display_range</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">highlight</span><span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">winner_index</span> <span class="o">==</span> <span class="n">key</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-348"><a href="#Logistic_Regression_Guard.get_local_explanations-348"><span class="linenos">348</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Decision plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-349"><a href="#Logistic_Regression_Guard.get_local_explanations-349"><span class="linenos">349</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-350"><a href="#Logistic_Regression_Guard.get_local_explanations-350"><span class="linenos">350</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-351"><a href="#Logistic_Regression_Guard.get_local_explanations-351"><span class="linenos">351</span></a>            <span class="n">shap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">beeswarm</span><span class="p">(</span><span class="n">shap</span><span class="o">.</span><span class="n">Explanation</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> 
</span><span id="Logistic_Regression_Guard.get_local_explanations-352"><a href="#Logistic_Regression_Guard.get_local_explanations-352"><span class="linenos">352</span></a>                                                            <span class="n">base_values</span><span class="o">=</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">processed_local_data</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-353"><a href="#Logistic_Regression_Guard.get_local_explanations-353"><span class="linenos">353</span></a>                                                            <span class="n">order</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)))</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-354"><a href="#Logistic_Regression_Guard.get_local_explanations-354"><span class="linenos">354</span></a>            <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-355"><a href="#Logistic_Regression_Guard.get_local_explanations-355"><span class="linenos">355</span></a>            <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-356"><a href="#Logistic_Regression_Guard.get_local_explanations-356"><span class="linenos">356</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;WIP: Beeswarm plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-357"><a href="#Logistic_Regression_Guard.get_local_explanations-357"><span class="linenos">357</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-358"><a href="#Logistic_Regression_Guard.get_local_explanations-358"><span class="linenos">358</span></a>
</span><span id="Logistic_Regression_Guard.get_local_explanations-359"><a href="#Logistic_Regression_Guard.get_local_explanations-359"><span class="linenos">359</span></a>            <span class="c1"># fig = plt.figure()</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-360"><a href="#Logistic_Regression_Guard.get_local_explanations-360"><span class="linenos">360</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">force_plot</span><span class="p">(</span><span class="n">explainer</span><span class="o">.</span><span class="n">expected_value</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-361"><a href="#Logistic_Regression_Guard.get_local_explanations-361"><span class="linenos">361</span></a>                            <span class="n">single_shap</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-362"><a href="#Logistic_Regression_Guard.get_local_explanations-362"><span class="linenos">362</span></a>                            <span class="n">unscaled_local_data</span><span class="p">,</span> <span class="n">out_names</span><span class="o">=</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">matplotlib</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-363"><a href="#Logistic_Regression_Guard.get_local_explanations-363"><span class="linenos">363</span></a>                            <span class="c1"># link=&#39;logit&#39;,</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-364"><a href="#Logistic_Regression_Guard.get_local_explanations-364"><span class="linenos">364</span></a>                            <span class="n">contribution_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-365"><a href="#Logistic_Regression_Guard.get_local_explanations-365"><span class="linenos">365</span></a>            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-366"><a href="#Logistic_Regression_Guard.get_local_explanations-366"><span class="linenos">366</span></a>            <span class="n">ret</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Force plot for </span><span class="si">{</span><span class="n">target_names</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span>
</span><span id="Logistic_Regression_Guard.get_local_explanations-367"><a href="#Logistic_Regression_Guard.get_local_explanations-367"><span class="linenos">367</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Get explainable representations for a single decision situation. </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>local_data (DataFrame):</strong>  A dataframe containing the single decision situation.</li>
<li><strong>base_sample (DataFrame):</strong>  A small (10-30) sample of the population for this decision point; Used for calculation of shap values.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Dict[str,Figure]: A dictionary containing the explainable representations for the single decision situation. Containing the following entries:</p>
  
  <ul>
  <li>"Decision plot (Multioutput)"</li>
  <li>"Decision plot for <code>X</code>" (for all output labels X)</li>
  <li>"Force plot for <code>X</code>" (for all output labels X)</li>
  </ul>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>